---
title: "–ü—Ä–∏–µ–º—ã —Ä–∞–±–æ—Ç—ã –∏ —Å–µ–∫—Ä–µ—Ç—ã ggplot2"
subtitle: "–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ —Å–æ–≤–µ—Ç—ã –ø–æ —Ä–∞–±–æ—Ç–µ —Å ggplot2"
author: "–ï.–ù. –ú–∞—Ç–µ—Ä–æ–≤"
date: "2024-03-04"
categories: [ggplot2, Rstats]
image: "ggplot2-theme-elements.png"
csl: "../../../gost-r-7-0-5-2008-numeric.csl"
lang: ru

filters:
  - social-share

share:
  permalink: "https://naukaidannye.netlify.app/"
  description: "–∫–ª–∞—Å—Å–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è"
  twitter: true
  email: true
  telegram: true
  mastodon: true

format:
  html:
    toc: true
    toc-depth: 2
    number-sections: false
    toc-location: left

citation: 
  url: https://www.naukaidannye.netlify.app/blog/posts/2024-01-26-ggplot2
  citation-key: Materov-ggplot2
  issued: "2024-01-26"
  language: ru 

css:
  - https://cdn.knightlab.com/libs/juxtapose/latest/css/juxtapose.css  
---

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ ggplot2

{{< li abwrkdvl trigger=loop speed=0.9 delay=1000 >}}

–í –Ω–∞—Å—Ç–æ—è—â–∏–π –º–æ–º–µ–Ω—Ç —Ç—Ä—É–¥–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Å–µ–±–µ, —á—Ç–æ –∫—Ç–æ-—Ç–æ –Ω–∞—á–∏–Ω–∞–µ—Ç –∏–∑—É—á–∞—Ç—å —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è **R** –∏ –Ω–µ —Å–ª—ã—à–∞–ª –æ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ [ggplot2](https://ggplot2.tidyverse.org/){target="_blank"}. –≠—Ç–æ –æ—á–µ–Ω—å –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å –ø–æ–º–æ—â—å—é –Ω–∞–ª–æ–∂–µ–Ω–∏—è —Å–ª–æ–µ–≤, —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏, —Ç–æ—á–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ. –ö—Ä–∞—Ç–∫–∏–µ –æ—Å–Ω–æ–≤—ã `ggplot2` –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ [—Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–ø—Ä–∞–≤–æ—á–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞](https://rstudio.github.io/cheatsheets/html/data-visualization.html){target="_blank"}.

–ü–æ –æ—Å–Ω–æ–≤–∞–º —Ä–∞–±–æ—Ç—ã —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –≤—ã–ø—É—â–µ–Ω–æ –Ω–µ–º–∞–ª–æ –∫–Ω–∏–≥, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å

- [ggplot2: Elegant Graphics for Data Analysis](https://ggplot2-book.org/){target="_blank"}

- [Data Visualization. A practical introduction](https://socviz.co/){target="_blank"}

- [Modern Data Visualization with R](https://rkabacoff.github.io/datavis/){target="_blank"}

- [–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é ggplot2](https://dmkpress.com/catalog/computer/statistics/978-5-97060-470-0/){target="_blank"}

- –ì–ª–∞–≤–∞ [–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∏ ggplot2](https://pozdniakov.github.io/tidy_stats/230-ggplot2.html){target="_blank"} –∫–Ω–∏–≥–∏ [–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ R](https://pozdniakov.github.io/tidy_stats/){target="_blank"}

–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –Ω–∞—É—á–∏—Ç—å—Å—è –æ—Å–Ω–æ–≤–∞–º –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ `ggplot2` -- —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏–∫–∞, –Ω–æ –∫–æ–≥–¥–∞ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ –¥–µ–ª–∞—é—Ç —á—Ç–æ-—Ç–æ —ç–∫—Å–ø–µ—Ä—Ç—ã, —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª, –Ω—É–∂–Ω–æ *–∫–æ—Ä–æ—Ç–∫–æ –∏ –ø–æ —Å—É—â–µ—Å—Ç–≤—É*, —Ç–æ –º—ã –ø—Ä–∏–±–µ–≥–∞–µ–º –∫ –∫—É—Ä—Å–∞–º. –ö—É—Ä—Å–æ–≤ –∏ –æ–±—É—á–∞—é—â–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ø–æ `ggplot2` –æ—á–µ–Ω—å –º–Ω–æ–≥–æ, –≤—ã–¥–µ–ª–∏–º –ª–∏—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö:

- **Claus O. Wilke**: –∫—É—Ä—Å [Data Visualization in R](https://wilkelab.org/SDS375/){target="_blank"} –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –∫–Ω–∏–≥–∏ [Fundamentals of Data Visualization](https://clauswilke.com/dataviz/){target="_blank"}

- **Dr. C√©dric Scherer**: –∫—É—Ä—Å [Engaging and Beautiful Data Visualizations with ggplot2](https://posit-conf-2023.github.io/dataviz-ggplot2/){target="_blank"}.

- **Dr. Andrew Heiss**: –∫—É—Ä—Å [Data Visualization with R](https://datavizs23.classes.andrewheiss.com/){target="_blank"}.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∏–µ —Ä–µ—Å—É—Ä—Å—ã –ø–æ `ggplot2` –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è: [ggplot2 extensions](https://exts.ggplot2.tidyverse.org/gallery/){target="_blank"}, [Awesome ggplot2](https://github.com/erikgahner/awesome-ggplot2/){target="_blank"}, [awesome-r-dataviz](https://krzjoa.github.io/awesome-r-dataviz/){target="_blank"} –∏ [ggplot tricks](https://github.com/teunbrand/ggplot_tricks){target="_blank"}.

–•–æ—Ä–æ—à–æ –æ—Ç—Ä–∞–∂–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ `ggplot2` –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ:

::: {#fig-ggplot2-theme-elements .column-body-outset-right}

![](ggplot2-theme-elements.png){.lightbox}

–≠–ª–µ–º–µ–Ω—Ç—ã –≥—Ä–∞—Ñ–∏–∫–∞ –≤ `ggplot2` ([–∏—Å—Ç–æ—á–Ω–∏–∫](https://isabella-b.com/blog/ggplot2-theme-elements-reference/){target="_blank"})

:::

–ù–µ —Å–ª–µ–¥—É–µ—Ç –∑–∞–±—ã–≤–∞—Ç—å, —á—Ç–æ –≤–∏–¥ –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (—á–∏—Å–ª–µ–Ω–Ω—ã–µ, –∫–∞—Ç–µ–≥–æ—Ä–Ω—ã–µ –∏ —Ç.–¥.), –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É–µ—Ç –æ—Ç—Ä–∞–∑–∏—Ç—å –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ –∏ —Ç–æ, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ [–¥–ª–∏–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ](https://r4ds.hadley.nz/data-tidy.html){target="_blank"}. –î–ª—è –≤—ã–±–æ—Ä–∞ –≤–∏–¥–∞ –≥—Ä–∞—Ñ–∏–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø–∞–º—è—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–±—Ä–∞–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ [Data Visualization Reference Guides](https://coolinfographics.com/dataviz-guides){target="_blank"}. –ü—Ä–∏–º–µ—Ä –ø–æ—Å—Ç–µ—Ä–∞ –ø–æ –≤—ã–±–æ—Ä—É –≥—Ä–∞—Ñ–∏–∫–∞ –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ.

::: {#fig-ggplot2-theme-elements .column-body-right}

![](poster_big.png){.lightbox}

–í–∏–¥—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö ([–∏—Å—Ç–æ—á–Ω–∏–∫](https://www.data-to-viz.com/){target="_blank"})

:::

–ù–µ—Å–æ–º–Ω–µ–Ω–Ω–æ, –æ–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö –≤–ø–µ—á–∞—Ç–ª—è—é—â–∏—Ö –≤–∫–ª–∞–¥–æ–≤ –≤ –ø–æ–ø—É–ª—è—Ä–∏–∑–∞—Ü–∏—é `ggplot2` —è–≤–ª—è—é—Ç—Å—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, [#TidyTuesday](https://github.com/topics/tidytuesday){target="_blank"}.

::: {.callout-warning appearance="simple"}

–î–∞–ª–µ–µ –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ (–≤–æ–∑–º–æ–∂–Ω–æ) –Ω–µ —Å–æ–≤—Å–µ–º –æ—á–µ–≤–∏–¥–Ω—ã–µ –ø—Ä–∏–µ–º—ã –∏ —Å–æ–≤–µ—Ç—ã –ø–æ —Ä–∞–±–æ—Ç–µ —Å `ggplot2` –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Å–º–æ—Ç—Ä–µ–Ω—ã —É –æ–ø—ã—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ. –î–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –ø–æ `ggplot2` –∏ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –∫–Ω–∏–≥–∏ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã.

:::

## –¢–µ–º—ã ggplot2 –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π

–î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ `ggplot2` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–µ–º. –ß—Ç–æ–±—ã –Ω–µ –∏—Å–∫–∞—Ç—å —Å—Ä–µ–¥–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞, –≤—ã–¥–µ–ª–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ, —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π. –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –±–∞–∑–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫, –æ—Ç–º–µ—Ç–∏–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –∫–æ–¥–µ.

```{r}
#| warning: false
# –∫–æ–ª–ª–µ–∫—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫ tidyverse üì¶
library(tidyverse)

# –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
library(palmerpenguins)
```

–ü—É—Å—Ç—å –Ω–∞—à –≥—Ä–∞—Ñ–∏–∫ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ä–∞–∑–º–µ—Ä—ã –∫–ª—é–≤–∞ –ø–∏–Ω–≥–≤–∏–Ω–æ–≤ –ø–æ –¥–∞–Ω–Ω—ã–º –∏–∑ [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://allisonhorst.github.io/palmerpenguins/){target="_blank"}`palmerpenguins`, –∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –º–∞—Å—Å—É —Ç–µ–ª–∞.

```{r}
#| fig-align: center
#| fig-cap: "–ò—Å—Ö–æ–¥–Ω—ã–π `ggplot2`-–≥—Ä–∞—Ñ–∏–∫"
#| label: fig-gg_base
#| code-overflow: wrap
gg_base <- 
  penguins |> 
  na.omit() |> 
  ggplot(aes(x = bill_length_mm,
             y = bill_depth_mm,
             fill = species,
             size = body_mass_g)) + 
  geom_point(pch = 21, # <1>
             color = "white", 
             alpha = 0.7) +
  scale_x_continuous(name = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º")) + # <2>
  scale_y_continuous(name = "–í—ã—Å–æ—Ç–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º"))

gg_base
```
1. –∑–¥–µ—Å—å `pch = 21` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É —Å–∏–º–≤–æ–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ —Ç–æ—á–µ–∫;
2. –∫–æ–º–∞–Ω–¥–∞ `scale_*_continuous(labels = function(x) str_c(x, " –º–º"))` –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è: *–º–º*) –∫ –∫–∞–∂–¥–æ–º—É —á–∏—Å–ª—É –Ω–∞ –æ—Å—è—Ö.

–ù–∞—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫.

```{r}
#| fig-align: center
#| fig.width: 6.5
#| fig.height: 5
#| fig-cap: "–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–π `ggplot2`-–≥—Ä–∞—Ñ–∏–∫"
#| label: fig-gg_custom
#| code-overflow: wrap
gg_base +
  theme_grey(base_size = 13) + # <1>
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571"),
    breaks = c("Adelie", "Chinstrap", "Gentoo"),
    labels = c("Adelie", "Chinstrap", "Gentoo"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4, # <2>
                          alpha = 1)
    ) 
  ) +
  guides(size = "none") + # <3>
  theme(
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"), # <4>
    plot.margin = ggplot2::margin(t = 0.01, # <5>
                                  r = 0.01, 
                                  b = 0.01, 
                                  l = 0.01, "cm")
  )
```
1. –±–∞–∑–æ–≤—ã–π —à—Ä–∏—Ñ—Ç –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–º–∞–Ω–¥–æ–π `theme_*(base_size = 13)`;
2. —Ä–∞–∑–º–µ—Ä –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Ç–æ—á–µ–∫ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º –≤ –ª–µ–≥–µ–Ω–¥–µ, —á—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ö–æ—Ä–æ—à–æ –¥–ª—è –ª–µ–≥–µ–Ω–¥—ã, –ø–æ—Å–∫–æ–ª—å–∫—É –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–ª–æ—Ö–æ –≤–∏–¥–Ω–∞, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–º–∞–Ω–¥–æ–π: `guides(color = guide_legend(override.aes = list(size = 4, alpha = 1)))`, –ø–µ—Ä–µ–ø–∏—Å–∞–≤ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ª–µ–≥–µ–Ω–¥—ã;
3. —É–±–∏—Ä–∞–µ—Ç –∏–∑ –ª–µ–≥–µ–Ω–¥—ã —ç–ª–µ–º–µ–Ω—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–∞–∑–º–µ—Ä—É —Ç–æ—á–µ–∫;
4. —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –ª–µ–≥–µ–Ω–¥–æ–π –∏ –≥—Ä–∞—Ñ–∏–∫–æ–º;
5. –∏–Ω–æ–≥–¥–∞ –≤–∞–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –ø–æ–ª—è, —Å–¥–µ–ª–∞–≤ –ø–æ–ª–µ–∑–Ω—É—é –ø–ª–æ—â–∞–¥—å –≥—Ä–∞—Ñ–∏–∫–∞ –±–æ–ª—å—à–µ, —É–∫–∞–∑–∞–≤ –æ—Ç—Å—Ç—É–ø—ã —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –≥—Ä–∞—Ñ–∏–∫–∞[^margins].

[^margins]: –ó–¥–µ—Å—å –ø–æ–ª—è —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ [—Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ](https://ggplot2.tidyverse.org/reference/element.html){target="_blank"}: `t = top, r = right, b = bottom, l = left`.

–ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Å–∞–º–æ–π [–±–∏–±–ª–∏–æ—Ç–µ–∫–µ](https://ggplot2.tidyverse.org/reference/ggtheme.html){target="_blank"} `ggplot2` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä—è–¥ —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞—É—á–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, `theme_bw()`, `theme_classic()`, `theme_light()` –∏–ª–∏ `theme_minimal()`, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤ `ggplot2` –∫–æ–¥–µ —Å–¥–µ–ª–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ, –Ω–∞–ø–∏—Å–∞–≤ –≤–º–µ—Å—Ç–æ `theme_grey()` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã.

### –¢–µ–º—ã `hrbrthemes`

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ç–µ–º—ã `ggplot2`. [–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://github.com/hrbrmstr/hrbrthemes){target="_blank"} `hrbrthemes`, –∫–æ—Ç–æ—Ä—É—é —Å–æ–∑–¥–∞–ª **Bob Rudis** –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤ **R** –≤–∏–∑—É–∞–ª—å–Ω–æ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞, –µ–≥–æ –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã–µ —Ç–µ–º—ã –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∏ —É–ø—Ä–æ—â–∞—é—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π. –ê–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥–æ–π 

```{.r}
remotes::install_github("hrbrmstr/hrbrthemes")
```
–î–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ç–µ–º—É `theme_ipsum()` –≤ –∫–æ–¥–µ.

```{r}
#| echo: false
#| warning: false
#| fig-align: center
#| fig.width: 6.5
#| fig.height: 5
#| fig-cap: "–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `hrbrthemes`"
#| label: fig-hrbrthemes-ggplot2
gg_base +
  hrbrthemes::theme_ipsum() + 
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571"),
    breaks = c("Adelie", "Chinstrap", "Gentoo"),
    labels = c("Adelie", "Chinstrap", "Gentoo"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4, 
                          alpha = 1)
    ) 
  ) +
  guides(size = "none") + 
  theme(
    legend.text = element_text(size = 12),
    axis.title.x = element_text(size = 11),
    axis.title.y = element_text(size = 11),
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"), 
    plot.margin = ggplot2::margin(t = 0.01, 
                                  r = 0.01, 
                                  b = 0.01, 
                                  l = 0.01, "cm")
  )
```

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫, –≤–∫–ª—é—á–∞—è —Ç–µ–º–Ω—É—é —Ç–µ–º—É, –≤–∞—Ä–∏–∞—Ü–∏–∏ —à—Ä–∏—Ñ—Ç–æ–≤ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫—É –æ—Å–µ–π.

### –¢–µ–º—ã `ggpubr`

[–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://rpkgs.datanovia.com/ggpubr/){target="_blank"} `ggpubr`(–∞–≤—Ç–æ—Ä **Alboukadel Kassambara**) –ø–æ–º–æ–≥–∞–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è–º –ª–µ–≥–∫–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏, –≥–æ—Ç–æ–≤—ã–µ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, —É–ø—Ä–æ—â–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å *p*-–∑–Ω–∞—á–µ–Ω–∏—è –∏ —É—Ä–æ–≤–Ω–∏ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –∫ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞–º, –ª–∏–Ω–µ–π–Ω—ã–º –≥—Ä–∞—Ñ–∏–∫–∞–º –∏ —Ç. –¥. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–∞–º–∏:

```{.r}
install.packages("ggpubr")
```
```{.r}
devtools::install_github("kassambara/ggpubr")
```
–°–ª–µ–¥—É—é—â–∏–π –≥—Ä–∞—Ñ–∏–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `theme_pubr()`.

```{r}
#| echo: false
#| warning: false
#| fig.width: 6.5
#| fig.height: 5
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `ggpubr`"
#| label: fig-ggpubr-ggplot2
gg_base +
  ggpubr::theme_pubr() + 
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571"),
    breaks = c("Adelie", "Chinstrap", "Gentoo"),
    labels = c("Adelie", "Chinstrap", "Gentoo"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4, 
                          alpha = 1)
    ) 
  ) +
  guides(size = "none") + 
  theme(
    legend.text = element_text(size = 11.5),
    axis.text = element_text(size = 10.6),
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"), 
    plot.margin = ggplot2::margin(t = 0.01, 
                                  r = 0.01, 
                                  b = 0.01, 
                                  l = 0.01, "cm")
  )
```

### –¢–µ–º—ã `silgelib`

**Julia Silge** —Å–æ–∑–¥–∞–ª–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ (–ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —à—Ä–∏—Ñ—Ç–æ–≤) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –≥—Ä–∞—Ñ–∏–∫–∞—Ö. –ó–∞–≥—Ä—É–∑–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Å —Ç–µ–º–∞–º–∏ –º–æ–∂–Ω–æ —Å *GitHub*:

```{.r}
devtools::install_github("juliasilge/silgelib")
```

–ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä —Ç–µ–º—ã: `silgelib::theme_roboto()`.

```{r}
#| echo: false
#| warning: false
#| fig.width: 6.5
#| fig.height: 5
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `silgelib`"
#| label: fig-silgelib-ggplot2
gg_base +
  silgelib::theme_roboto() + 
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571"),
    breaks = c("Adelie", "Chinstrap", "Gentoo"),
    labels = c("Adelie", "Chinstrap", "Gentoo"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4, 
                          alpha = 1)
    ) 
  ) +
  guides(size = "none") + 
  theme(
    legend.text = element_text(size = 12),
    axis.text = element_text(size = 11),
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"), 
    plot.margin = ggplot2::margin(t = 0.01, 
                                  r = 0.01, 
                                  b = 0.01, 
                                  l = 0.01, "cm")
  )
```

- –ï—Å–ª–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ç–µ–º –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–º –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://jrnold.github.io/ggthemes/reference/index.html){target="_blank"} `ggthemes`, –Ω–∞–ø—Ä–∏–º–µ—Ä, `theme_tufte()` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∏–ª—è, –∞–≤—Ç–æ—Ä –∫–æ—Ç–æ—Ä–æ–≥–æ [Edward Tufty](https://www.edwardtufte.com/tufte/){target="_blank"} –∏–ª–∏ `theme_fivethirtyeight()`. 
- [–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://wilkelab.org/ggridges/){target="_blank"} `ggridges` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è *—Ö—Ä–µ–±—Ç–æ–≤—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º* (*—Ä–∏–¥–∂–ª–∞–π–Ω–æ–≤*), –æ–¥–Ω–∞–∫–æ —É –Ω–µ–µ —Ç–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–µ–º–∞ –¥–ª—è `ggplot2` –ø–æ –∫–æ–º–∞–Ω–¥–µ `ggridges::theme_ridges()`. 
- –¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç —É–ø–æ–º—è–Ω—É—Ç—å —Ç–µ–º—ã `bbplot` –∏–∑ [BBC Visual and Data Journalism cookbook for R graphics](https://bbc.github.io/rcookbook/){target="_blank"} –∏ [ftplottools::ft_theme()](https://github.com/Financial-Times/ftplottools/blob/master/R/ft_theme.R){target="_blank"}.

### –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–µ–≥–µ–Ω–¥–∞ –≥—Ä–∞—Ñ–∏–∫–∞

–ò–Ω–æ–≥–¥–∞ —É–¥–æ–±–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è [–±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π](https://github.com/MattCowgill/ggdirectlabel){target="_blank"} `ggdirectlabel`, –∫–æ—Ç–æ—Ä–∞—è —Å–ª—É–∂–∏—Ç –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –Ω–∞–Ω–µ—Å–µ–Ω–∏—è —É—Å–ª–æ–≤–Ω—ã—Ö –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–π –≤ `ggplot2`, –ø–µ—Ä–µ–Ω–æ—Å—è –∏—Ö –≤–Ω—É—Ç—Ä—å –¥–∏–∞–≥—Ä–∞–º–º—ã –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ª–µ–≥–µ–Ω–¥—ã. –ù–∞ —Ä–∏—Å—É–Ω–∫–µ –ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä –∑–∞–º–µ–Ω—ã –ª–µ–≥–µ–Ω–¥—ã –Ω–∞ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –∫–æ–º–∞–Ω–¥–∞, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–¥ –¥–ª—è `ggplot2`-–≥—Ä–∞—Ñ–∏–∫–∞:

```{.r}
+ geom_richlegend(aes(label = species, color = species))
```

```{r}
#| echo: false
#| warning: false
#| fig.width: 6.5
#| fig.height: 5
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä —É–ø—Ä–æ—â–µ–Ω–∏—è –ª–µ–≥–µ–Ω–¥—ã —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `ggdirectlabel`"
#| label: fig-ggdirectlabel-ggplot2
library(ggdirectlabel)

penguins |> 
  na.omit() |> 
  ggplot(aes(x = bill_length_mm,
             y = bill_depth_mm,
             fill = species,
             size = body_mass_g)) + 
  geom_richlegend(aes(label = species, 
                      color = species)) +
  geom_point(pch = 21, 
             color = "white", 
             alpha = 0.8) +
  scale_x_continuous(name = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_y_continuous(name = "–í—ã—Å–æ—Ç–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571")) +
  scale_color_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571")) +
  guides(size = "none") +
  ggpubr::theme_pubr() +
  theme(
    legend.title = element_text(size = 14),
    axis.title.x = element_text(size = 11),
    axis.title.y = element_text(size = 11),
    legend.position = "none",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"),
    plot.margin = ggplot2::margin(t=0.01, 
                                  r=0.5, 
                                  b=0.5, 
                                  l=0.5, "cm") 
  )
```

### –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å —Ç–µ–º—É?

–ï—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã–µ —Ç–µ–º—ã –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º—ã –Ω–∏—á–µ–≥–æ –Ω–µ —Å–∫–∞–∑–∞–ª–∏ –≤—ã—à–µ –ø—Ä–æ —Ç–µ–º–Ω—ã–µ —Ç–µ–º—ã), —Å–¥–µ–ª–∞–≤ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —Ä–æ–¥–µ *–ø—Ä–∏–º–µ—Ä–∫—É*. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [–±–∏–±–ª–∏–æ—Ç–µ–∫—É](https://github.com/lukastay/ggautothemes){target="_blank"} `ggautothemes`, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∂–µ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥—è—Ç —Å–≤—ã—à–µ 30 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–µ–º –≤ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –≥—Ä–∞—Ñ–∏–∫—É. 

```{.r}
library(ggautothemes)
```

–ü—É—Å—Ç—å `gg_base` -- –∏—Å—Ö–æ–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫, —Ç–æ–≥–¥–∞ –º–æ–∂–Ω–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–±–æ—Ä –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–µ–º–∞–º–∏ –ø–æ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```{.r}
# —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Å —Ç–µ–º–∞–º–∏ –ø–æ –∏—Å—Ö–æ–¥–Ω–æ–º—É
autoallthemes(gg_base)
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º—ã

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `theme_set()` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ–º—ã, –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—è —Ç–µ–∫—É—â—É—é —Ç–µ–º—É. –ú–æ–∂–Ω–æ –æ–¥–Ω–∏–º –ø—Ä–∏–µ–º–æ–º –∑–∞–¥–∞—Ç—å —Ç–µ–º—É –¥–ª—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```{.r}
theme_set(
  # —Å—Ç–∞—Ä—Ç–æ–≤–∞—è —Ç–µ–º–∞
  ggplot2::theme_classic() +
  # —ç–ª–µ–º–µ–Ω—Ç—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–æ–π —Ç–µ–º—ã
  theme(
    legend.text = element_text(size = 12),
    axis.title.x = element_text(size = 11),
    axis.title.y = element_text(size = 11),
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"),
    plot.margin = ggplot2::margin(t = 0.01, 
                                  r = 0.01, 
                                  b = 0.01, 
                                  l = 0.01, "cm")
  )
```

–î–ª—è –ª—é–±–æ–π —Ç–µ–º—ã –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç —Ç–µ–º—ã, –∏—Å–ø–æ–ª—å–∑—É—è `[[`. –ó–∞—Ç–µ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä `%+replace%` –¥–ª—è –∑–∞–º–µ–Ω—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ç–µ–º—ã –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—É—Å—Ç—å –º—ã —Ö–æ—Ç–∏–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –≥—Ä–∞—Ñ–∏–∫—É `gg_base` —Ç–µ–º—É `theme_ipsum()` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `hrbrthemes` –≤–µ–∑–¥–µ, –∫—Ä–æ–º–µ —Ç–µ–∫—Å—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –æ—Å—è–º:

```{r}
#| warning: false
#| message: false
#| fig.width: 6.3
#| fig.height: 5.2
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –∑–∞–º–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ç–µ–º—ã"
#| label: fig-replace-ggplot2
gg_base +
  hrbrthemes::theme_ipsum(grid = "XY", 
                          base_size = 14) %+replace% 
  theme(axis.title = ggthemes::theme_gdocs()[["axis.title"]],
        axis.title.x = ggthemes::theme_gdocs()[["axis.title.x"]],
        axis.title.y = ggthemes::theme_gdocs()[["axis.title.y"]],
        legend.position = "none") +
  NULL
```

–û—Ç–º–µ—Ç–∏–º, —á—Ç–æ –∫–æ–¥ –≤—ã—à–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è `+ NULL`, —ç—Ç–æ —É–¥–æ–±–Ω–æ –≤ —Å–ª—É—á–∞–µ –æ—Ç–ª–∞–¥–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞, –∫–æ–≥–¥–∞ –±—É–¥—É—Ç –µ—â–µ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—Ç—Ä–æ–∫–∏ –≤ –∫–æ–¥.

## –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –≤ `ggplot2` –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è [–±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π](https://patchwork.data-imaginist.com/){target="_blank"} `patchwork`. –ó–¥–µ—Å—å –∞–ª–≥–µ–±—Ä–∞ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–∞—è: –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –¥–∞–Ω—ã –≥—Ä–∞—Ñ–∏–∫–∏ `p1`, `p2`, —Ç–æ `p1 | p2` —Ä–∞–∑–º–µ—Å—Ç–∏—Ç –≥—Ä–∞—Ñ–∏–∫–∏ —Ä—è–¥–æ–º –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º, `p1 / p2` —Ä–∞–∑–º–µ—Å—Ç–∏—Ç –∏—Ö –¥—Ä—É–≥ –Ω–∞–¥ –¥—Ä—É–≥–æ–º –∏ —Ç.–¥.

–û–¥–∏–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –ø—Ä–∏–µ–º–æ–≤, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–∏–ª [June Choe](https://yjunechoe.github.io/){target="_blank"}.

::: {.callout-note appearance="simple"}

–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `I()` (*AsIs* variables) –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å `ggplot2` –≤–µ—Ä—Å–∏–∏ 3.5.0 –∏ –≤—ã—à–µ.

:::

```{r}
#| message: false
#| warning: false
library(patchwork)

x <- 1:100
y <- x^2  
df_combine <- data.frame(x, y)

p <- ggplot(df_combine, aes(x, y)) +
  geom_line() +
  theme_grey(base_size = 14)
```

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-summary: "–ö–æ–¥: —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤"
annotate_broken_axis <- function(pos, size = 0.03){
  mid <- switch(
    pos,
    "bl" = list(x = 0, y = 0),
    "br" = list(x = 1, y = 0),
    "tl" = list(x = 0, y = 1),
    "tr" = list(x = 1, y = 1)
  )
  slash <- annotate(
    "segment",
    x = I(mid$x - size), xend = I(mid$x + size),
    y = I(-size), yend = I(size)
  )
  list(slash, coord_cartesian(clip = "off"))
}
```

```{r}
#| message: false
#| warning: false
#| code-overflow: wrap
#| fig-height: 4.4
#| fig-width: 8
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤"
#| label: fig-combine-ggplot2

scale_mark <- 
scale_y_continuous(labels = function(x) format(x, big.mark = " ",
                                                 scientific = FALSE)) 

p1 <- p +
  scale_x_continuous(limits = c(1, 70)) +
  annotate_broken_axis(pos = "br") +
  scale_mark

p2 <- p +
  scale_x_continuous(limits = c(80, 100)) +
  annotate_broken_axis(pos = "bl") +
  scale_mark

p1 + p2 +
  plot_layout(axis = "collect") &
  theme(axis.line.x = element_line())
```

–í –∫–æ–¥–µ –≤—ã—à–µ —Ñ—É–Ω–∫—Ü–∏—è –≤–Ω—É—Ç—Ä–∏ `scale_y_continuous(...)`  –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –¥–ª—è —Ä–∞–∑—Ä—è–¥–æ–≤ —Ç—ã—Å—è—á. 

## –ù–∞–¥–≥—Ä–∞—Ñ–∏–∫–∏

–û–¥–Ω–∞ –∏–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∫ –≥—Ä–∞—Ñ–∏–∫—É -- –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ *–Ω–∞–¥–≥—Ä–∞—Ñ–∏–∫–æ–≤* –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ [–ø–∞–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é](https://ggplot2.tidyverse.org/reference/facet_wrap.html){target="_blank"}, —á—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ [ggside](https://github.com/jtlandis/ggside){target="_blank"}.

```{r}
#| code-fold: true
#| code-overflow: wrap
#| code-summary: "–ö–æ–¥: –±–∞–∑–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∏"
gg_side_plot <- 
  penguins |> 
  na.omit() |> 
  ggplot(aes(x = bill_length_mm,
             y = bill_depth_mm,
             fill = species)) + 
  geom_point(pch = 21,
             size = 4,
             color = "white", 
             alpha = 0.8) +
  theme_grey(base_size = 13) +
  scale_fill_manual(
    values = c("#0072B2", 
               "#D55E00", 
               "#018571")
  ) +
  scale_x_continuous(name = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_y_continuous(name = "–í—ã—Å–æ—Ç–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  theme(
    legend.position = "none",
    plot.margin = ggplot2::margin(t = 0.01,
                                  r = 0.01, 
                                  b = 0.01, 
                                  l = 0.01, "cm")
  )
```

–í—Å–µ –≥–µ–æ–º–µ—Ç—Ä–∏–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ `ggside` –∏–º–µ—é—Ç —à–∞–±–ª–æ–Ω `geom_xside*` –∏–ª–∏ `geom_yside*` –∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–ª–æ—è –≤ `ggplot2`-–≥—Ä–∞—Ñ–∏–∫ –∫–∞–∫ –æ–±—ã—á–Ω–æ.

```{r}
#| message: false
#| warning: false
#| fig.width: 6.5
#| fig.height: 6
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è"
#| label: fig-ggside-ggplot2
library(ggside)

gg_side_plot +
  geom_xsideboxplot(aes(y = species), 
                    orientation = "y",
                    alpha = 0.8) +
  geom_ysidedensity(aes(x = after_stat(density)), 
                    position = "identity",
                    alpha = 0.8) +
  scale_ysidex_continuous(guide = guide_axis(angle = 90), 
                          minor_breaks = NULL) +
  theme(ggside.panel.scale = 0.3)
```

# –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Å—Ç–µ—Ç–∏–∫–∏

–ü—É—Å—Ç—å –Ω–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å —Ü–≤–µ—Ç/–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ (`color`/`fill`) —Å–≤–µ—Ç–ª–µ–µ/—Ç–µ–º–Ω–µ–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥–∞. –î–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `after_stat()`, –∞ –¥–ª—è –∫–æ—Å–≤–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `aes()` -- –æ–ø–µ—Ä–∞—Ç–æ—Ä ¬´–±—ç–Ω–≥-–±—ç–Ω–≥-–±—ç–Ω–≥¬ª `!!!` –∫–∞–∫ –≤ —Å—Ç–∞—Ç—å–µ [ggplot tricks](https://github.com/teunbrand/ggplot_tricks){target="_blank"}, –∫–æ—Ç–æ—Ä—É—é –Ω–∞–ø–∏—Å–∞–ª **Teun van den Brand**.

–ü—É—Å—Ç—å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–æ—á–µ–∫ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–µ–Ω—å—à–µ –∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 0.3 –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —è—Ä–∫–æ—Å—Ç–∏ –≥—Ä–∞–Ω–∏—Ü—ã.

```{r}
#| message: false
#| warning: false
my_fill_light <- aes(fill = after_scale(alpha(colour, 0.3)))
```

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-overflow: wrap
#| code-summary: "–ö–æ–¥: –±–∞–∑–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫"
gg_base_aes <- penguins |> 
  na.omit() |>
  ggplot(aes(x = bill_length_mm,
             y = bill_depth_mm,
             size = body_mass_g)) +
  scale_x_continuous(name = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_y_continuous(name = "–í—ã—Å–æ—Ç–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  theme_classic(base_size = 14) +
  scale_color_manual(
    values = c(male = "#0072B2", 
               female = "#D55E00"),
    breaks = c("male", "female"),
    labels = c("–º—É–∂", "–∂–µ–Ω"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4,
                                 alpha = 1)
    ) 
  ) +
  guides(size = "none") +
  theme(
    axis.line = element_line(),
    panel.background = element_rect(fill = "white"),
    panel.grid.major = element_line("grey90", 
                                    linewidth = 0.3),
    legend.key = element_rect(fill = NA),
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"),
    plot.margin = ggplot2::margin(t = 0.5,
                                  r = 0.5, 
                                  b = 0.5, 
                                  l = 0.5, "cm")
  )
```

```{r}
#| message: false
#| warning: false
#| fig.width: 6.5
#| fig.height: 6
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ü–≤–µ—Ç–∞"
#| label: fig-aes-rlang-ggplot2

library(rlang)

gg_base_aes +
  geom_point(aes(colour = factor(sex), 
                 !!!my_fill_light), shape = 21)
```

```{r}

```

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤, —Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑—Ü–∏–∏ —Ä—É—Ç–∏–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π -- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ [—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π](https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html#using-aes-and-vars-in-a-package-function){target="_blank"} `ggplot2`. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `{{` `}}` –∏ –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ –Ω–∏–∂–µ, –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ `col` -- –∏–º—è —Å—Ç–æ–ª–±—Ü–∞:

```{.r}
function(df, col) {
  ggplot(df) + 
    geom_*(aes(x = {{ col }}))
}
```

–ü—Ä–∏–≤–µ–¥–µ–º –ø—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Ç–æ–ª–±–∏–∫–æ–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É —á–∏—Å–ª–æ–≤–æ–π –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞, –¥–∞–Ω–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å [–ø–æ—è–≤–∏–ª–∞—Å—å](https://www.tidyverse.org/blog/2024/02/ggplot2-3-5-0/){target="_blank"} –≤ `ggplot2` –≤–µ—Ä—Å–∏–∏ 3.5.0 –∏ –≤—ã—à–µ.

```{r}
# —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
library(grid)
turbo_colors <- scales::viridis_pal(option = "inferno")(10)
grad_colors <- linearGradient(turbo_colors, 
                              group = TRUE)
```

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-overflow: wrap
#| code-summary: "–ö–æ–¥: –ø—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤"
barplot_fun <- function(data, x) {
  ggplot(data, 
         aes(x = {{ x }})) +
    geom_bar(fill = grad_colors, color = "white") +
    scale_y_continuous(name = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ", 
                       labels = function(x) format(x, big.mark = " ",
                                                   scientific = FALSE)) +
  hrbrthemes::theme_ipsum(grid = "Y") +
    theme(
      axis.line = element_line(),
      axis.title.x = element_text(size = 12),
      axis.title.y = element_text(size = 12),
      panel.grid.major = element_line("grey90", 
                                      linewidth = 0.3),
      plot.margin = ggplot2::margin(t = 0.1,
                                    r = 0.1, 
                                    b = 0.1, 
                                    l = 0.1, "cm")
    )
  
}
```

```{r}
#| fig-height: 7.2
#| fig-width: 7
#| fig-align: center
#| message: false
#| warning: false
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –≥—Ä—É–ø–ø—ã —Å—Ö–æ–¥–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤"
#| label: fig-function1-ggplot2
library(patchwork)

barplot1 <- barplot_fun(diamonds, cut)
barplot2 <- barplot_fun(mpg, class)

barplot1 / barplot2
```

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä `%+%` –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏–ª–∏ –∑–∞–º–µ–Ω—ã –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-overflow: wrap
#| code-summary: "–ö–æ–¥: –ø—Ä–∏–º–µ—Ä –±–∞–∑–æ–≤–æ–π —á–∞—Å—Ç–∏ –≥—Ä–∞—Ñ–∏–∫–∞"
bar_chart <- ggplot() +
  geom_bar(fill = grad_colors, color = "white") +
  scale_y_continuous(name = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ", 
                     labels = function(x) format(x, big.mark = " ",
                                                 scientific = FALSE)) +
  hrbrthemes::theme_ipsum(grid = "Y") +
  theme(
    axis.line = element_line(),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    panel.grid.major = element_line("grey90", 
                                    linewidth = 0.3),
    plot.margin = ggplot2::margin(t = 0.1,
                                  r = 0.1, 
                                  b = 0.1, 
                                  l = 0.1, "cm")
  )
```

```{r}
#| fig-height: 7.2
#| fig-width: 7
#| fig-align: center
#| message: false
#| warning: false
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –≥—Ä—É–ø–ø—ã —Å—Ö–æ–¥–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤"
#| label: fig-function2-ggplot2
library(patchwork)

barchart1 <- bar_chart %+% diamonds + 
  aes(cut)

barchart2 <- bar_chart %+% mpg + 
  aes(class)

barchart1 / barchart2
```

## –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏

–ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö, –Ω–æ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é.

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-overflow: wrap
#| code-summary: "–ö–æ–¥: —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤"
plot_density <- function(data, var, grp = "") {
  ggplot(data, aes(x = !!sym(var))) +
    geom_density(aes(fill = !!sym(grp)), 
             position = "identity",
             alpha = 0.7) +
    scale_x_continuous(labels = function(x) str_c(x, " –º–º")) +
    silgelib::theme_roboto(base_size = 13) +
    viridis::scale_fill_viridis(name = NULL,
                                option = "plasma",
                                direction = -1,
                                discrete = TRUE) +
    theme(legend.position = "top",
          plot.margin = ggplot2::margin(t = 0.1,
                                        r = 0.1, 
                                        b = 0.1, 
                                        l = 0.1, "cm"))
}
```

–û—Ç–º–µ—Ç–∏–º, —á—Ç–æ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `plot_density` –º—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–µ–π –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –ø–∞–ª–∏—Ç—Ä—ã —á–µ—Ä–µ–∑ `scale_fill_viridis`, –ø–æ—Å–∫–æ–ª—å–∫—É –∑–∞—Ä–∞–Ω–µ–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –≥—Ä–∞—Ñ–∏–∫–µ. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –ø–æ—Å—Ç—Ä–æ–∏–º –¥–≤–∞ –≥—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `bill_length_mm` –∏ `bill_depth_mm`.

```{r}
#| message: false
#| warning: false
plots <- purrr::map(
  c("bill_length_mm", "bill_depth_mm"), 
  ~ plot_density(data = penguins |> na.omit(), 
                 var = .x, grp = "sex")
)
```

```{r}
#| fig-height: 3.8
#| fig-width: 8
#| fig-align: center
#| message: false
#| warning: false
#| fig-cap: "–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏"
#| label: fig-iterative-ggplot2
patchwork::wrap_plots(plots, nrow = 1)
```

```{r}
#| echo: false
# https://posit-conf-2023.github.io/dataviz-ggplot2/materials/01-fundamentals.html#/conditional-components
# smooth <- TRUE

#ggplot(bikes, aes(x = temp, y = humidity)) +
#  { if(smooth) geom_smooth(color = "red") } +
#  geom_point(alpha = .5)

#–î–ª–∏–Ω–Ω—ã–µ –Ω–∞–¥–ø–∏—Å–∏ –≤ ggplot, –ø–µ—Ä–µ–Ω–æ—Å
#https://stringr.tidyverse.org/reference/str_trunc.html

#https://datavizs23.classes.andrewheiss.com/

#–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

#https://www.cedricscherer.com/2023/07/05/efficiency-and-consistency-automate-subset-graphics-with-ggplot2-and-purrr/
```

# –¶–≤–µ—Ç–∞ –∏ –ø–∞–ª–∏—Ç—Ä—ã

## –ü–∞–ª–∏—Ç—Ä—ã

–¶–≤–µ—Ç–æ–≤—ã–µ –ø–∞–ª–∏—Ç—Ä—ã –≤ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω—ã –≤—ã—è–≤–ª—è—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–æ–±–Ω–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

```{r}
#| fig-height: 3.8
#| fig-width: 7.3
#| fig-align: center
#| echo: false
#| warning: false
#| fig-cap: "–¢–∏–ø—ã —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–∞–ª–∏—Ç—Ä"
#| label: fig-palette-type-ggplot2
library(unikn)
library(paletteer)
seecol(list(paletteer_d("RColorBrewer::PuBu"), 
            paletteer_d("colorBlindness::Blue2DarkOrange18Steps"), 
            paletteer_d("ggsci::default_jco")), n = 8, grid = F, lwd_brd = 1,
       pal_names = c("sequental", 
                     "diverging", 
                     "qualitative"), 
       title = "–¢–∏–ø—ã —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–∞–ª–∏—Ç—Ä")
```       

–û–¥–Ω–æ–π –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø–∞–ª–∏—Ç—Ä –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ `ggplot2` —è–≤–ª—è–µ—Ç—Å—è `viridis` (—Å–º. [Introduction to the viridis color maps](https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html){target="_blank"}). 
–¶–≤–µ—Ç–∞ `viridis` –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —à–∏—Ä–æ–∫—É—é –ø–∞–ª–∏—Ç—Ä—É, —á—Ç–æ–±—ã —Ä–∞–∑–ª–∏—á–∏—è –±—ã–ª–∏ –ª–µ–≥–∫–æ –∑–∞–º–µ—Ç–Ω—ã, *color blind* —É—Å—Ç–æ–π—á–∏–≤—ã, –ø—Ä–∏ —ç—Ç–æ–º –∑–Ω–∞—á–µ–Ω–∏—è, –±–ª–∏–∑–∫–∏–µ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É, –∏–º–µ—é—Ç —Å—Ö–æ–∂–∏–µ —Ü–≤–µ—Ç–∞, –∞ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–∞—Ö–æ–¥—è—â–∏–µ—Å—è –¥–∞–ª–µ–∫–æ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞, –∏–º–µ—é—Ç –±–æ–ª—å—à–µ —Ä–∞–∑–ª–∏—á–∏–π. 

```{r}
#| echo: false
#| warning: false
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–π —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã `viridis`"
#| label: fig-viridis-ggplot2
library(scales)
show_col(pal_viridis()(9), ncol = 3)
```

–û—Å–Ω–æ–≤–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `viridis` –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∞ –µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ü–≤–µ—Ç–æ–≤—ã–º–∏ –≥–∞–º–º–∞–º–∏: `magma`, `plasma`, `inferno`, `cividis`, `mako`, `rocket` –∏ `turbo`. –£–¥–æ–±–Ω–æ —Ç–æ, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–∞–Ω–¥—ã `scale_color_viridis()` –∏–ª–∏ `scale_fill_viridis()` –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `direction = 1` –∏–ª–∏ `direction = -1` –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ü–≤–µ—Ç–æ–≤ –∏ `discrete = TRUE`, –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞.

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –ø–∞–ª–∏—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –≤ `ggplot2`, —ç—Ç–æ:

- `ggsci` ([Scientific Journal and Sci-Fi Themed Color Palettes for ggplot2](https://nanx.me/ggsci/articles/ggsci.html){target="_blank"})
- `ggokabeito` ([discrete, colorblind-friendly *Okabe-Ito* palette](https://malcolmbarrett.github.io/ggokabeito/index.html){target="_blank"})
- `scico` ([Palettes for R based on the Scientific Colour-Maps](https://github.com/thomasp85/scico){target="_blank"})
- `tidyterra` ([Gradient palettes in tidyterra](https://dieghernan.github.io/tidyterra/articles/palettes.html){target="_blank"})

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —Ü–≤–µ—Ç–æ–≤—ã—Ö –ø–∞–ª–∏—Ç—Ä:

- [colorbrewer2.org](https://colorbrewer2.org/){target="_blank"}
- [R Color Palettes 1](https://emilhvitfeldt.github.io/r-color-palettes/){target="_blank"} + [R Color Palettes 2](https://r-charts.com/color-palettes/){target="_blank"} -- –ø–∞–ª–∏—Ç—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://emilhvitfeldt.github.io/paletteer/){target="_blank"} `paletteer`

–ë–æ–ª—å—à–µ –æ —Ü–≤–µ—Ç–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö **R** –≤–µ—Ä—Å–∏–∏ –≤—ã—à–µ 4.0.0 –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –≤ —Å—Ç–∞—Ç—å–µ [Coloring in R‚Äôs Blind Spot](https://journal.r-project.org/articles/RJ-2023-071/){target="_blank"}.

## –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–º

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π –∏ –Ω–∞ —Ñ–æ–Ω–µ –æ–±—â–µ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤—ã–¥–µ–ª–∏—Ç—å –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞. –£–¥–æ–±–Ω–æ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é —Ü–≤–µ—Ç–∞ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å [–±–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://cran.r-project.org/web/packages/gghighlight/vignettes/gghighlight.html){target="_blank"} `gghighlight`.

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-overflow: wrap
#| code-summary: "–ö–æ–¥: –±–∞–∑–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫"

gg_highlight <- 
penguins |> 
  na.omit() |>
  ggplot(aes(x = flipper_length_mm, 
             fill = species)) + 
  geom_bar() +
  silgelib::theme_roboto(base_size = 14) +
  ggsci::scale_fill_nejm(alpha = 0.9) +
  scale_x_continuous(name = "–†–∞–∑–º–∞—Ö –ø–ª–∞–≤–Ω–∏–∫–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  labs(y = "–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ") +
  theme(
    axis.line = element_line(),
    panel.grid.major = element_line("grey95", 
                                    linewidth = 0.3),
    plot.margin = ggplot2::margin(t = 0.5,
                                  r = 0.5, 
                                  b = 0.5, 
                                  l = 0.5, "cm")
  )
```

```{r}
#| fig-height: 4.2
#| fig-width: 8
#| fig-align: center
#| warning: false
#| message: false
#| fig-cap: "–ë–∞–∑–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫"
#| label: fig-highlight-ggplot2
gg_highlight
```

```{r}
#| fig-height: 3.4
#| fig-width: 8.2
#| fig-align: center
#| lightbox: true
#| warning: false
#| message: false
#| fig-cap: "–í—ã–¥–µ–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–º –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `gghighlight`"
#| label: fig-gghighlight-ggplot2
library(gghighlight)

gg_highlight +
  gghighlight() +
  facet_wrap(~species)
```


```{r}
#| echo: false
#How to Make Curved Text in ggplot2
#https://www.youtube.com/watch?v=wsJWHwSIXJs&ab_channel=RfortheRestofUs

#How to use multiple colour scales in ggplot with `ggnewscale`
#https://gradientdescending.com/how-to-use-multiple-color-scales-in-ggplot-with-ggnewscale/

#https://posit-conf-2023.github.io/dataviz-storytelling/modules/s03-display.html
#https://posit-conf-2023.github.io/dataviz-ggplot2/modules/s01-fundamentals.html

#???
#https://www.infoworld.com/article/3667496/12-ggplot-extensions-for-snazzier-r-graphics.html
```

## –ò–∑–º–µ–Ω–µ–Ω–∏–µ —à–∫–∞–ª—ã

–í –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—ã–±–µ—Ä–µ–º [North Carolina SIDS data](https://jakubnowosad.com/spData/reference/nc.sids.html){target="_blank"}. –ü—É—Å—Ç—å —Ü–≤–µ—Ç —Å–æ–æ—Å—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–ª–æ—â–∞–¥–∏ –ø–æ–ª–∏–≥–æ–Ω–æ–≤ –≥—Ä–∞—Ñ—Å—Ç–≤ –≤ –≥—Ä–∞–¥—É—Å–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö, –∞ –≤—ã–¥–µ–ª–µ–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -- –æ–∫—Ä—É–≥ –§—Ä–∞–Ω–∫–ª–∏–Ω, –°–µ–≤–µ—Ä–Ω–∞—è –ö–∞—Ä–æ–ª–∏–Ω–∞, –°–®–ê.

```{r}
#| message: false
#| warning: false
nc <- sf::st_read(system.file("shape/nc.shp", package = "sf"), 
                  quiet = TRUE)
```

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-summary: "–ö–æ–¥: –∏—Å—Ö–æ–¥–Ω–∞—è –∫–∞—Ä—Ç–∞"
gg_map <- ggplot(nc) +
  geom_sf(aes(fill = AREA),
          color = "black",
          linewidth = 0.2) +
  labs(fill = "–ø–ª–æ—â–∞–¥—å") +
  hrbrthemes::theme_ipsum() +
  guides(fill = guide_colorbar(title.position = "top", 
                                title.hjust = 0.5,
                                barwidth = unit(20, "lines"), 
                                barheight = unit(0.7, "lines"))) +
  theme(legend.position = "top",
        legend.text = element_text(size = 12),
        legend.title = element_text(size = 14),
        plot.margin = ggplot2::margin(t = 0.01,
                                      r = 0.01, 
                                      b = 0.01, 
                                      l = 0.01, "cm"))
                                      
gg_map
```

–î–ª—è –∫–∞—Ä—Ç—ã –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –ø–∞–ª–∏—Ç—Ä—É —Å –ø–æ–º–æ—â—å—é [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://emilhvitfeldt.github.io/paletteer/){target="_blank"} `paletteer` –∏–∑ [–Ω–∞–±–æ—Ä–∞](https://r-charts.com/color-palettes/){target="_blank"}. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –¥–æ–±–∞–≤–∏–≤ –≤ –∫–æ–¥ –≥—Ä–∞—Ñ–∫–∞ 

```{.r}
+ paletteer::scale_fill_paletteer_*("ggthemes::palette_name", 
                                    direction = -1)
```

–ü—Ä–∏ —ç—Ç–æ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ `direction = 1` –∏–ª–∏ `direction = -1`. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–π —à–∫–∞–ª—ã –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Å—Ä–µ–¥–Ω—é—é —Ç–æ—á–∫—É —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `rescaler = ~ rescale_mid(.x, mid = mid_point_value)`. –ü—É—Å—Ç—å —Ü–≤–µ—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —à–∫–∞–ª–µ `ggthemes::Classic Orange-Blue`, –∞ —Ü–µ–Ω—Ç—Ä —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—é 0.2.

```{r}
#| echo: false
# https://github.com/tidyverse/ggplot2/issues/3738
# https://scales.r-lib.org/reference/rescale_mid.html
```

```{r}
#| warning: false
#| message: false
#| code-overflow: wrap
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–≤–µ—Ç–æ–≤–æ–π —à–∫–∞–ª—ã"
#| label: fig-color-center-ggplot2
library(paletteer)

gg_map +
  scale_fill_paletteer_c("ggthemes::Classic Orange-Blue", 
                         direction = -1,
                         rescaler = ~ rescale_mid(.x, mid = 0.20)
  )
```

–°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–≤–µ—Ç–∞ –º–æ–∂–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–¥–∏–∞–Ω—É –∏–ª–∏ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –¥–æ–ª—é, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–¥–µ–ª–∏–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—é, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–≤–Ω–æ `r round(max(abs(nc$AREA)), 2) / 2`.

```{r}
#| warning: false
#| message: false
#| code-overflow: wrap
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ –≤ —Ü–≤–µ—Ç–æ–≤–æ–π —à–∫–∞–ª–µ"
#| label: fig-color-limits-ggplot2

gg_map +
  paletteer::scale_fill_paletteer_c("ggthemes::Classic Orange-Blue", 
                                    direction = -1,
                                    limits = ~ c(0, 1) * max(abs(.x))
  )
```


# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

## –ê–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

[–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://rviews.rstudio.com/2019/09/19/intro-to-ggforce/){target="_blank"} `ggforce` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∏–∫–æ–π `ggplot2`. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∫ –≥—Ä—É–ø–ø–∞–º –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ, –≤—ã–¥–µ–ª–∏–≤ –æ–±–ª–∞—Å—Ç–∏ –∏ —Å–Ω–∞–±–¥–∏–≤ –∏—Ö —Å–Ω–æ—Å–∫–∞–º–∏.

<details>
<summary>–ö–æ–¥: –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</summary>

```{r}
#| message: false
#| warning: false

penguins_without_na <- penguins |> na.omit()

# –∏—Å—Ö–æ–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
gg_penguins <- 
  penguins_without_na |> 
  ggplot(aes(x = bill_length_mm,
             y = bill_depth_mm,
             fill = species,
             size = body_mass_g)) + 
  geom_point(pch = 21,
             color = "white", 
             alpha = 0.7)

# –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
gg_plot <- gg_penguins +
  silgelib::theme_roboto(base_size = 14) +
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4,
                          alpha = 1)
    ) 
  ) +
  guides(size = "none") +
  theme(
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"),
    legend.text = element_text(size = 13),
    plot.margin = ggplot2::margin(t = 0.5,
                                  r = 0.5, 
                                  b = 0.5, 
                                  l = 0.5, "cm")
  ) +
  labs(x = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞ (–º–º)",
       y = "–í—ã—Å–æ—Ç–∞ –∫–ª—é–≤–∞ (–º–º)") +
  xlim(min(penguins_without_na$bill_length_mm) - 5, 
       max(penguins_without_na$bill_length_mm) + 5) +
  ylim(min(penguins_without_na$bill_depth_mm) - 2, 
       max(penguins_without_na$bill_depth_mm) + 2)
```

</details>

```{r}
#| warning: false
#| fig.width: 7
#| fig.height: 6.3
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –≤—ã–¥–µ–ª–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç–µ–π –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ ggforce"
#| label: fig-ggforce-annotate-ggplot2
 
library(ggforce)

gg_plot + 
  geom_mark_ellipse(aes(label = species),
                    linewidth = 0.5,
                    show.legend = FALSE)
```

## –¢–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ –≥—Ä–∞—Ñ–∏–∫–∞

–í –≥—Ä–∞—Ñ–∏–∫ `ggplot2` –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ª—é–±–æ–π `markdown`-—Ç–µ–∫—Å—Ç –¥–ª—è HTML-–∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—É—Ä—Å–∏–≤ –∏–ª–∏ –ø–æ–ª—É–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç, –∞ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–º —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://wilkelab.org/ggtext/{target="_blank"}) `ggtext`.

```{r}
#| message: false
#| warning: false
#| code-overflow: wrap
#| code-fold: true
#| code-summary: "–ö–æ–¥: –ø—Ä–∏–º–µ—Ä –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö —Ç–µ–º—ã"
#| fig.width: 7
#| fig.height: 7.5
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö —Ç–µ–º—ã"
#| label: fig-text-annotate-ggplot2
library(ggtext)
library(glue)

gg_plot + 
  geom_mark_ellipse(aes(label = species),
                    linewidth = 0.5,
                    show.legend = FALSE) +
  labs(
    title = "<b>–ü–∏–Ω–≥–≤–∏–Ω—ã –ü–∞–ª–º–µ—Ä–∞</b><br>
    <span style = 'font-size:10pt; color:grey'>–ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö <span style = 'color:black;'>palmerpenguins</span> –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è 
    –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª —Å–æ–±—Ä–∞–Ω —É—á–∞—Å—Ç–Ω–∏–∫–æ–º **Long Term Ecological Research Network** -- <span style = 'color:black;'>Dr. Kristen Gorman</span> —Å–æ —Å—Ç–∞–Ω—Ü–∏–∏ 
    **Palmer Station, Antarctica LTER** –∏ –¥–∞–ª–µ–µ –æ–±–æ–±—â–µ–Ω –∞–≤—Ç–æ—Ä–∞–º–∏: 
    <span style = 'color:black;'>Allison Horst</span>, 
    <span style = 'color:black;'>Alison Hill</span>, 
    <span style = 'color:black;'>Kristen Gorman</span>.
    –î–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è —Ç—Ä–∏ –≤–∏–¥–∞ –ø–∏–Ω–≥–≤–∏–Ω–æ–≤: 
    <span style = 'color:#0072B2;'>Adelie</span>, 
    <span style = 'color:#D55E00;'>Chinstrap</span> –∏ 
    <span style = 'color:#018571;'>Gentoo</span>.</span>"
  ) +
  theme(
    plot.title.position = "plot",
    plot.title = element_textbox_simple(
      size = 14,
      lineheight = 1,
      padding = margin(5.5, 5.5, 5.5, 5.5),
      margin = margin(0, 0, 5.5, 0)
    )
  )
```

## –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–∏ –≥—Ä–∞—Ñ–∏–∫–∞

–í `ggplot2` –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —á–∞—Å—Ç—å –≥—Ä–∞—Ñ–∏–∫–∞, –ø—Ä–∏—á–µ–º –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å "–∑—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" –º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏. 

### –ó—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ ggforce

–ü—Ä–∏–≤–µ–¥–µ–º –ø—Ä–∏–º–µ—Ä —É–≤–µ–ª–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–∏ –≥—Ä–∞—Ñ–∏–∫–∞ —Å –ø–æ–º–æ—â—å—é —É–∂–µ —É–ø–æ–º—è–Ω—É—Ç–æ–π [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://ggforce.data-imaginist.com/){target="_blank"} `ggforce`. –î–∞–Ω–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —á–∞—Å—Ç—å –≥—Ä–∞—Ñ–∏–∫–∞.

```{r}
#| warning: false
#| message: false
#| code-fold: true
#| code-summary: "–ö–æ–¥: –∏—Å—Ö–æ–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫"
# –∏—Å—Ö–æ–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
gg_for_scale <- penguins |> 
  na.omit() |> 
  ggplot(aes(x = bill_length_mm,
             y = bill_depth_mm,
             fill = species,
             size = body_mass_g)) + 
  geom_point(pch = 21,
             color = "white", 
             alpha = 0.7) +
  theme_bw(base_size = 13) +
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4,
                          alpha = 1)
    ) 
  ) +
  guides(size = "none") +
  theme(
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"),
    legend.text = element_text(size = 13),
    plot.margin = ggplot2::margin(t = 0.5,
                                  r = 0.5, 
                                  b = 0.5, 
                                  l = 0.5, "cm")
  ) +
  labs(x = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞",
       y = "–í—ã—Å–æ—Ç–∞ –∫–ª—é–≤–∞") +
  scale_x_continuous(name = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_y_continuous(name = "–í—ã—Å–æ—Ç–∞ –∫–ª—é–≤–∞",
                     labels = function(x) str_c(x, " –º–º"))
```

–ó—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–∏ –≥—Ä–∞—Ñ–∏–∫–∞.

```{r}
#| message: false
#| warning: false
#| fig.width: 7.5
#| fig.height: 6
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä —É–≤–µ–ª–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–∏ –≥—Ä–∞—Ñ–∏–∫–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `ggforce`"
#| label: fig-ggforce-zoom-ggplot2
gg_for_scale + facet_zoom(xlim = c(40, 45), 
                          show.area = TRUE)
```

–ü—Ä–∏–≤–µ–¥–µ–º –µ—â–µ –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä –∑—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –∑–¥–µ—Å—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.

```{r}
#| message: false
#| warning: false
#| fig.width: 7.5
#| fig.height: 7
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä —É–≤–µ–ª–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–∏ –≥—Ä–∞—Ñ–∏–∫–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `ggforce`"
#| label: fig-ggforce-zoom-variable-ggplot2
gg_for_scale + facet_zoom(xy = species == "Chinstrap", 
                          split = TRUE)
```

### –ó—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ ggmagnify

–°–ª–µ–¥—É—é—â–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –∑—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è -- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://hughjonesd.github.io/ggmagnify/){target="_blank"} `ggmagnify`, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞–∫

```{.r}
remotes::install_github("hughjonesd/ggmagnify")
```

–ü–æ–∫–∞–∂–µ–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—Ç—ã.

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-summary: "–ö–æ–¥: –∏—Å—Ö–æ–¥–Ω–∞—è –∫–∞—Ä—Ç–∞"

nc_Franklin <- nc |> filter(NAME == "Franklin")

gg_map_Franklin <- gg_map +
  geom_sf(data = nc_Franklin,
          fill = "#BF0A30") +
  geom_sf_label(data = nc_Franklin,
                aes(label = NAME), 
                nudge_x = 0.06, 
                nudge_y = 0.35,
                alpha = 0.9) +
  labs(x = "", y = "") + 
  tidyterra::scale_fill_whitebox_c(na.value = "gray80", 
                        palette = "deep")
```

```{r}
#| message: false
#| warning: false
#| fig.width: 8
#| fig.height: 5
#| fig-align: center
#| fig-cap: "–ò—Å—Ö–æ–¥–Ω–∞—è –∫–∞—Ä—Ç–∞"
#| label: fig-map-nc-ggplot2
gg_map_Franklin
```

–£–≤–µ–ª–∏—á–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –æ–±—ä–µ–∫—Ç.

```{r}
#| message: false
#| warning: false
#| code-summary: "–ö–æ–¥: –∑—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ ggmagnify"
#| code-fold: true
#| fig.width: 8
#| fig.height: 5
#| fig-align: center
#| fig-cap: "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `ggmagnify`"
#| label: fig-map-ggmagnify-ggplot2
library(ggmagnify)

gg_map_Franklin + 
  geom_magnify(aes(from = NAME == "Franklin"),
               to = c(-83, -81, 34, 35.8), 
               shadow = TRUE, 
               linewidth = 0.6, 
               colour = "grey20",
               shape = "rect", 
               aspect = "fixed",
               alpha = 0.8,
               expand = 0) + 
  tidyterra::scale_fill_whitebox_c(na.value = "gray80", 
                        palette = "deep")
```


### –ó—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ ggmapinset

–ï—â–µ –æ–¥–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –∑—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è -- [–±–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://cidm-ph.github.io/ggmapinset/index.html){target="_blank"} `ggmapinset`. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã–Ω–æ—Å–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –ø–æ–º–æ—â—å—é –≥–ª–∞–≥–æ–ª–æ–≤-–∫–æ–º–∞–Ω–¥, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –Ω–∞ `*_inset`. –ó–¥–µ—Å—å –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–º) –¥–ª—è —Ä–∞–¥–∏—É—Å–∞ –æ–±–ª–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–≤–µ–ª–∏—á–∏—Ç—å.

```{r}
#| message: false
#| warning: false
#| code-summary: "–ö–æ–¥: –∑—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ ggmapinset"
#| code-fold: true
#| code-overflow: wrap
#| fig.width: 8
#| fig.height: 5
#| fig-align: center
#| fig-cap: "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `ggmapinset`"
#| label: fig-map-ggmapinset-ggplot2
library(ggmapinset)

gg_map +
  geom_sf_inset(aes(fill = AREA),
                color = "black",
                linewidth = 0.2) +
  geom_sf_inset(data = nc_Franklin,
                fill = "#BF0A30") +
  geom_inset_frame() +
  geom_sf_label(data = nc_Franklin,
                aes(label = NAME), 
                nudge_x = 0.06, 
                nudge_y = 0.35,
                alpha = 0.9) +
  coord_sf_inset(inset = 
                   configure_inset(
                     centre = sf::st_centroid(sf::st_geometry(nc_Franklin)), 
                     scale = 2.2,
                     translation = c(-300, -200), 
                     radius = 40, 
                     units = "km"
                   )) +
  labs(x = "", y = "") + 
  tidyterra::scale_fill_whitebox_c(na.value = "gray80", 
                        palette = "deep")
```

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

–û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —É—Å–∏–ª–µ–Ω–∏—è –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –≤ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ -- —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ —à–µ–π–¥–µ—Ä–∞–º–∏ –Ω–∞ —Å–ª–æ—è—Ö `ggplot2` –≤ [–±–∏–±–ª–∏–æ—Ç–µ–∫–µ](https://ggfx.data-imaginist.com/index.html){target="_blank"} `ggfx`. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–Ω–∏ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –≥—Ä–∞—Ñ–∏–∫—É.

```{r}
#| message: false
#| warning: false
#| code-fold: true
#| code-overflow: wrap
#| code-summary: "–ö–æ–¥: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∫ –≥—Ä–∞—Ñ–∏–∫—É"
#| fig.width: 8
#| fig.height: 5
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–Ω–∏ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `ggfx`"
#| label: fig-shaddow-ggplot2

library(ggfx)

gg_map +
  with_shadow(
    sigma = 3, x_offset = 4, y_offset = 4,
    geom_sf(data = nc, 
            aes(fill = AREA), 
            color = "black")
  ) + 
  tidyterra::scale_fill_whitebox_c(na.value = "gray80", 
                        palette = "deep")
```

## –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏

–ï—Å–ª–∏ –≤ –Ω–∞—É—á–Ω–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤, —Ç–æ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è [—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º](https://indrajeetpatil.github.io/ggstatsplot/){target="_blank"} `ggstatsplot`. –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è `ggstatsplot` —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é —Å–æ—Å—Ç–∞–≤–ª—è—é—â—É—é —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏. –ó–¥–µ—Å—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Å–ª–µ–¥—É–µ–º—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –¥–æ–≤–æ–ª—å–Ω–æ –≤–Ω—É—à–∏—Ç–µ–ª—å–Ω–æ–µ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å. –ü—Ä–∏–≤–µ–¥–µ–º –ø—Ä–∏–º–µ—Ä —Ç–∞–∫–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞.

```{r}
#| message: false
#| warning: false
#| fig.width: 7.5
#| fig.height: 4.8
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö"
#| label: fig-ggstatsplot-ggplot2
set.seed(2024)
library(ggstatsplot)

ggbetweenstats(
  data  = penguins |> na.omit(),
  x     = species,
  y     = bill_length_mm
)
```



## –í–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è

–° –ø–æ–º–æ—â—å—é `ggplot2` –º–æ–∂–Ω–æ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `broom` –∏ —Ç.–¥. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞, –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–º–∞–Ω–¥—É `autoplot()`. –ü—É—Å—Ç—å —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–∏–Ω–≥–≤–∏–Ω–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–∞—Ö–∞ –ø–ª–∞–≤–Ω–∏–∫–∞ –∏ –¥–ª–∏–Ω—ã –∫–ª—é–≤–∞.

```{r}
#| message: false
#| warning: false

# –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞ –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π
library(partykit)

# –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π
library(ggparty)
```

```{r}
# –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π
penguin_ctree <- ctree(
  # —Ñ–æ—Ä–º—É–ª–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
  species ~ flipper_length_mm + bill_length_mm,
  data = penguins |> na.omit()
)
```

```{r}
#| warning: false
#| fig.width: 7.5
#| fig.height: 5.5
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π"
#| label: fig-ggparty-ggplot2
autoplot(penguin_ctree) + 
  theme_void()
```


–ü–æ–∫–∞–∂–µ–º, –∫–∞–∫ –º–æ–∂–Ω–æ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Å—Ç–µ–π—à–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π –≤ [–±–∏–±–ª–∏–æ—Ç–µ–∫–µ](https://grantmcdermott.com/parttree/articles/parttree-intro.html){target="_blank"} `parttree`. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–µ—Ä–µ–≤—å—è–º–∏ —Ä–µ—à–µ–Ω–∏–π, —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ –≤ `rpart`, `partykit`, `tidymodels` –∏ `mlr3`.

–ü—É—Å—Ç—å `gg_for_tree` -- –∏—Å—Ö–æ–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫.

```{r}
#| echo: false
#| include: false
#| message: false
#| warning: false
gg_for_tree <- penguins |> 
  na.omit() |> 
  ggplot(aes(x = flipper_length_mm,
             y = bill_length_mm,
             fill = species)) + 
  geom_point(pch = 21,
             size = 3,
             color = "white", 
             alpha = 0.7) +
  scale_x_continuous(name = "\n–†–∞–∑–º–∞—Ö –ø–ª–∞–≤–Ω–∏–∫–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_y_continuous(name = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞\n",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571"),
    breaks = c("Adelie", "Chinstrap", "Gentoo"),
    labels = c("Adelie", "Chinstrap", "Gentoo"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4, 
                          alpha = 1)
    ) 
  ) +
  hrbrthemes::theme_ipsum(grid = "",
                          base_size = 14) +
  theme(
    legend.text = element_text(size = 13),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"),
    plot.margin = ggplot2::margin(t=0.5, 
                                  r=0.5, 
                                  b=0.5, 
                                  l=0.5, "cm") 
  )
```

<details>
<summary>–ö–æ–¥: –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π</summary>

```{.r}
gg_for_tree <- penguins |> 
  na.omit() |> 
  ggplot(aes(x = flipper_length_mm,
             y = bill_length_mm,
             fill = species)) + 
  geom_point(pch = 21,
             size = 3,
             color = "white", 
             alpha = 0.7) +
  scale_x_continuous(name = "\n–†–∞–∑–º–∞—Ö –ø–ª–∞–≤–Ω–∏–∫–∞",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_y_continuous(name = "–î–ª–∏–Ω–∞ –∫–ª—é–≤–∞\n",
                     labels = function(x) str_c(x, " –º–º")) +
  scale_fill_manual(
    values = c(Adelie = "#0072B2", 
               Chinstrap = "#D55E00", 
               Gentoo = "#018571"),
    breaks = c("Adelie", "Chinstrap", "Gentoo"),
    labels = c("Adelie", "Chinstrap", "Gentoo"),
    name = NULL,
    guide = guide_legend(
      direction = "horizontal",
      override.aes = list(size = 4, 
                          alpha = 1)
    ) 
  ) +
   hrbrthemes::theme_ipsum(grid = "",
                          base_size = 14) +
  theme(
    legend.text = element_text(size = 13),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    legend.position = "top",
    legend.justification = "right",
    legend.box.spacing = unit(0.1, "cm"),
    plot.margin = ggplot2::margin(t=0.5, 
                                  r=0.5, 
                                  b=0.5, 
                                  l=0.5, "cm") 
  )
```
</details>

–û—Ç–æ–±—Ä–∞–∑–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –º–æ–¥–µ–ª–∏ `penguin_ctree`, –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≤—ã—à–µ, —Å –ø–æ–º–æ—â—å—é —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç–µ–π –≥—Ä–∞—Ñ–∏–∫–∞.

```{r}
#| message: false
#| warning: false

# –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–¥–≥–æ–Ω–∫—É –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π
library(parttree)
```

```{r}
#| warning: false
#| fig.width: 7
#| fig.height: 5.8
#| fig-align: center
#| fig-cap: "–ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `parttree`"
#| label: fig-parttree-ggplot2
gg_for_tree +
  geom_parttree(data = penguin_ctree, 
                aes(fill = species), 
                alpha = 0.2)

```






# –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `ggplot2` —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è **R**, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ [–ì—Ä–∞–º–º–∞—Ç–∏–∫–µ –≥—Ä–∞—Ñ–∏–∫–∏](https://link.springer.com/book/10.1007/0-387-28695-0){target="_blank"}, –ø—Ä–∏—á–µ–º, –∏–¥–µ–æ–ª–æ–≥–∏—è –∏ –∫—É–ª—å—Ç—É—Ä–∞ `ggplot2` –Ω–∞—Å—Ç–æ–ª—å–∫–æ —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π, —á—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∏ –≤ –¥—Ä—É–≥–∏–µ —è–∑—ã–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ **Python** –∏ **Julia** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ [TidierPlots.jl](https://github.com/TidierOrg/TidierPlots.jl){target="_blank"}).

::: {.column-margin}

<head>
  <!-- add the button style & script -->
  <link rel="stylesheet" href="../../../dist/applause-button.css" />
  <script src="../../../dist/applause-button.js"></script>
</head>
<body>
  <!-- add the button! -->
  <applause-button style="width: 58px; height: 58px;"/>
</body>

:::

–í –æ–±–∑–æ—Ä–µ –Ω–µ –±—ã–ª–∏ —É–ø–æ–º—è–Ω—É—Ç—ã –º–Ω–æ–≥–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ –¥–æ—Å—Ç–æ–π–Ω—ã –≤–Ω–∏–º–∞–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤ —Ç–æ–π –∏–ª–∏ –∏–Ω–æ–π –º–µ—Ä–µ `ggplot2`, –ª–∏–±–æ —è–≤–ª—è—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º–∏: `ggnewscale`, `GGally`, `ggrough`, `gghalves`, `see`, `biscale`, `ggdist`, `ggdensity`, `ggblend`, `ggsurvfit`, `camcoder`, `geomtextpath` –∏ –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ `ggplot2` –º–æ–∂–Ω–æ –ø—Ä–æ—á–µ—Å—Ç—å –≤ —Å—Ç–∞—Ç—å—è—Ö [–±–ª–æ–≥–∞ Tidyverse](https://www.tidyverse.org/tags/ggplot2/){target="_blank"}, [—Å—Ç–∞—Ç—å—è—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://ggplot2.tidyverse.org/articles/){target="_blank"}, [Top 50 ggplot2 Visualizations - The Master List (With Full R Code)](https://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html){target="_blank"}, [ggplot tricks](https://github.com/teunbrand/ggplot_tricks){target="_blank"}, –∞ —Ç–∞–∫–∂–µ –Ω–∞ [YouTube](https://www.youtube.com/hashtag/ggplot){target="_blank"}.


:::{.callout-tip collapse="true"}
## Session Info
```{r}
#| echo: false

library(sessioninfo)

pkg_sesh <- session_info(pkgs = "attached")

quarto_version <- system("quarto --version", intern = TRUE)

pkg_sesh$platform$quarto <- paste(
  system("quarto --version", intern = TRUE)
  )

pkg_sesh
```

:::