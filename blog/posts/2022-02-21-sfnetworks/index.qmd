---
title: "–ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏"
subtitle: "–ü—Ä–∏–º–µ—Ä—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥–æ—Ä–æ–¥—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥—Ä–∞—Ñ–æ–≤, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ"
author: "–ï.–ù. –ú–∞—Ç–µ—Ä–æ–≤"
date: "2022-02-21"
date-modified: "2024-03-04"
categories: [sfnetworks, spatial, Rstats]
image: "sfnetworks.png"
csl: "../../../gost-r-7-0-5-2008-numeric.csl"
lang: ru

filters:
  - social-share

share:
  permalink: "https://naukaidannye.netlify.app/"
  description: "–∫–ª–∞—Å—Å–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è"
  twitter: true
  email: true
  telegram: true
  mastodon: true

format:
  html:
    toc: true
    toc-depth: 2
    number-sections: false
    toc-location: left

citation: 
  url: https://www.naukaidannye.netlify.app/blog/posts/2021-11-22-spatial
  citation-key: Materov-spatial
  issued: "2022-02-21"
  language: ru
---

{{< li zzjjvkam trigger=loop speed=0.9 delay=1000 >}}

# –í–≤–µ–¥–µ–Ω–∏–µ

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥–æ—Ä–æ–¥–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ [Network analysis library](https://docs.qgis.org/3.16/en/docs/pyqgis_developer_cookbook/network_analysis.html#network-analysis-library){target="_blank"} –≥–µ–æ–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã [QGIS](https://www.qgis.org/ru/site/){target="_blank"} –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–ª–∏–Ω–µ–π–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö —Å–ª–æ–µ–≤) —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä–∞—Ñ—ã –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∏–º–∏ –∫–∞–∫ —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏, –∞ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∞ —è–∑—ã–∫–µ **Python**. –ú–æ–¥—É–ª—å [QNEAT3](https://root676.github.io/){target="_blank"} –¥–ª—è *QGIS* —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–µ—Ç–µ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –∫—Ä–∞—Ç—á–∞–π—à–µ–≥–æ –ø—É—Ç–∏ –¥–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏–∑–æ—Ö—Ä–æ–Ω (—Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–∞–∫ –∑–æ–Ω—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è, –ø–æ–ª–∏–≥–æ–Ω—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏), —Å–º. —Ç–∞–∫–∂–µ –≥–ª–∞–≤—É [–ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å–µ—Ç–µ–π](https://aentin.github.io/qgis-course/networks.html){target="_blank"} –∏–∑ –ø—Ä–∞–∫—Ç–∏–∫—É–º–∞ [[–ê. –≠–Ω—Ç–∏–Ω, –¢. –°–∞–º—Å–æ–Ω–æ–≤, –ê. –ö–∞—Ä–ø–∞—á–µ–≤—Å–∫–∏–π](https://aentin.github.io/qgis-course/){target="_blank"}].

–í —è–∑—ã–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è **R** —Å—É—â–µ—Å—Ç–≤—É–µ—Ç [–±–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://luukvdmeer.github.io/sfnetworks/){target="_blank"} `sfnetworks`, —Ü–µ–ª—å –∫–æ—Ç–æ—Ä–æ–π -- —Ä–∞–±–æ—Ç–∞ —Å –≥–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏, —Ç.–µ. –≥—Ä–∞—Ñ–∞–º–∏, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –≤ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–∞–∫ —É–∑–ª—ã, —Ç–∞–∫ –∏ —Ä–µ–±—Ä–∞ –≥—Ä–∞—Ñ–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤. –¢–∞–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–≥—Ä–∞—é—Ç –≤–∞–∂–Ω—É—é —Ä–æ–ª—å –≤–æ –º–Ω–æ–≥–∏—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö, –Ω–∞—á–∏–Ω–∞—è –æ—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∏, –∑–∞–∫–∞–Ω—á–∏–≤–∞—è —ç–∫–æ–ª–æ–≥–∏–µ–π –∏ —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∏–µ–π.

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `sfnetworks` —Å–æ—á–µ—Ç–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–≤—É—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫: `sf`, —É—á–∏—Ç—ã–≤–∞—é—â–µ–π –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ `tidygraph` (–Ω–∞ –æ—Å–Ω–æ–≤–µ `igraph`) –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä–∞—Ñ–æ–≤. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≥–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –≤—ã—Ö–æ–¥—è—Ç –∑–∞ —Ä–∞–º–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –≥—Ä–∞—Ñ–æ–≤, –∏ –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –∏—Ö –∞–Ω–∞–ª–∏–∑–µ –∫—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ —è–≤–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–µ–∫—Ü–∏–∏. –í –±–∏–±–ª–∏–æ—Ç–µ–∫—É `sfnetworks` –≤–Ω–µ–¥—Ä–µ–Ω—ã –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Ä–∞—Å—á–µ—Ç–∞ –∫—Ä–∞—Ç—á–∞–π—à–µ–≥–æ –ø—É—Ç–∏, –æ—á–∏—Å—Ç–∫–∏ —Å–µ—Ç–∏ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–ø–æ–ª–æ–≥–∏–∏, —á—Ç–æ –≤ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã `tidyverse`, –¥–µ–ª–∞–µ—Ç –µ–µ –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º. –û—Ç–º–µ—Ç–∏–º —Å—Ö–æ–¥—Å—Ç–≤–æ –¥–∞–Ω–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ —Å –∏–∑–≤–µ—Å—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π [OSMnx](https://geoffboeing.com/2016/11/osmnx-python-street-networks/){target="_blank"}, –∞ —Ç–∞–∫–∂–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π [Pyrosm](https://pyrosm.readthedocs.io/en/latest/index.html){target="_blank"} —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è **Python**.

# –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –≥—Ä–∞—Ñ–æ–º –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏

–ë–∏–±–ª–∏–æ—Ç–µ–∫—É `sfnetworks` –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–¥–Ω–∏–º –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤: –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è [CRAN](https://cran.r-project.org/web/packages/sfnetworks/index.html){target="_blank"}

```{.r}
install.packages("sfnetworks")
```

–ª–∏–±–æ —Å [GitHub](https://github.com/luukvdmeer/sfnetworks)

```{.r}
remotes::install_github("luukvdmeer/sfnetworks")
```

–ó–∞–≥—Ä—É–∑–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è.

```{r setup}
#| message: false
#| warning: false

# –æ–±—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
library(tidyverse)
library(magrittr)

# —Ä–∞–±–æ—Ç–∞ —Å –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
library(osmdata)
library(osrm)
library(sf)

# —à–∫–∞–ª–∞ –º–∞—Å—à—Ç–∞–±–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
library(ggspatial)

# future! üöÄ
library(future)
plan(sequential)
```

## –ë–∞–∑–æ–≤–∞—è –∫–∞—Ä—Ç–∞

::: {.callout-important appearance="simple"}
–í —Å–≤–æ–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –º—ã –±—É–¥–µ–º –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç [–ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–ø–∏—Å–∏](https://naukaidannye.netlify.app/blog/posts/2021-11-22-reachability/){target="_blank"} –±–ª–æ–≥–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥–æ—Ä–æ–¥–∞ (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –≥. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫). –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –¥–∞–Ω–Ω—ã–µ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç–∞—Ç—å–µ.
:::

–î–æ–ø—É—Å—Ç–∏–º, —á—Ç–æ —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `osmdata` –º—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ *OpenStreetMap*, –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –∏—Ö.

```{.r}
base_map +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.75, 93.04), 
           ylim = c(55.98, 56.09),
           expand = FALSE) +
  # —à–∫–∞–ª–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
  annotation_scale(location = "tl", 
                   width_hint = 0.5, 
                   style = "ticks") +
  theme_void()
```

::: {#fig-KRSK_base .column-body-inset-right}

![](KRSK_base.png){.lightbox}

–ö–∞—Ä—Ç–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥–æ—Ä–æ–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö *OpenStreetMap*
:::

## –ì—Ä–∞—Ñ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ –∏–∑ *OpenStreetMap*, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ –¥–æ—Ä–æ–∂–Ω—É—é —Å–µ—Ç—å –Ω–æ—Å–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ `streets`. –í—ã–¥–µ–ª–∏–º —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ [Simple feature](https://r-spatial.github.io/sf/articles/sf1.html#simple-feature-geometry-types){target="_blank"} (—Å–º. —Ç–∞–∫–∂–µ [[–¢.–ï. –°–∞–º—Å–æ–Ω–æ–≤](https://tsamsonov.github.io/r-geo-course/09-SpatialData.html#vector_data_r){target="_blank"}]), –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç —Ç–∏–ø `LINESTRING`.

```{.r}
streets_lines <- streets |>
  dplyr::select(osm_id, 
                oneway, 
                highway) %>% 
  filter(
    st_geometry_type(.)
    %in% c("LINESTRING")
  )
```

–ó–∞—Ç–µ–º, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ [[–¢.–ï. –°–∞–º—Å–æ–Ω–æ–≤](https://tsamsonov.github.io/r-geo-course/16-NetworkAnalysis.html#%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%D0%BD%D1%8B%D0%B9-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7){target="_blank"}] –∏ [[Dealing with one-way edges](https://luukvdmeer.github.io/sfnetworks/articles/sfn02_preprocess_clean.html#dealing-with-one-way-edges){target="_blank"}] –ø—Ä–æ–¥—É–±–ª–∏—Ä—É–µ–º –ª–∏–Ω–∏–∏, –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–æ—Ä–æ–≥–∞–º —Å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –¥–≤–∏–∂–µ–Ω–∏–µ–º –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Ä–æ–≥–∏ —Å –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –¥–≤–∏–∂–µ–Ω–∏–µ–º.

```{.r}
streets_double_lanes <- streets_lines |>
  filter(is.na(oneway) | oneway != "yes") |>
  st_reverse() |>
  bind_rows(streets_lines)
```

–ó–∞–≥—Ä—É–∑–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É `sfnetworks`.

```{r}
#| message: false
#| warning: false

library(sfnetworks)

# —Ä–∞–±–æ—Ç–∞ —Å –≥—Ä–∞—Ñ–∞–º–∏ –≤ R
library(tidygraph)
```

–¢–µ–ø–µ—Ä—å, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –≥—Ä–∞—Ñ –∏–∑ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏, –Ω—É–∂–Ω–∞ –±—É–∫–≤–∞–ª—å–Ω–æ –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `sfnetworks`.

```{r}
#| echo: false
#| message: false
#| warning: false
#| include: false

streets_double_lanes <- st_read("/Users/materov/@–¥–∞–Ω–Ω—ã–µ/@–±–ª–æ–≥_naukaidannye/2022-02-21-sfnetworks/streets_double_lanes.gpkg")
```

```{r}
net <- as_sfnetwork(streets_double_lanes) |>
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è
  st_transform(4326)
```

–ü–æ–ª—É—á–∏–≤—à–∏–π—Å—è –≥—Ä–∞—Ñ, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π `tidy`-—Ñ–æ—Ä–º–∞—Ç —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤, –≥–¥–µ –∫–∞–∂–¥–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∏–º–µ–µ—Ç —Å–≤–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.

:::{.smaller .column-page-inset-right}
```{r}
net
```
:::

–ù–∞–Ω–µ—Å–µ–º –ø–æ–≤–µ—Ä—Ö –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –≥—Ä–∞—Ñ. –ö–∞–∫ –≤–∏–¥–Ω–æ, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å—è –¥–æ—Ä–æ–∂–Ω–∞—è —Å–µ—Ç—å –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ–æ–º.

<details>
<summary>–ö–æ–¥: –≥—Ä–∞—Ñ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏</summary>

```{.r}
base_map + 
  # –∑–¥–∞–Ω–∏—è –∏ —Å—Ç—Ä–æ–µ–Ω–∏—è
  geom_sf(data = buildings, linewidth = 0.15) +
  # —Ä–µ–±—Ä–∞ –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(net, "edges"), 
          col = "red", alpha = 0.4) +
  # –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(net, "nodes"), 
          col = "maroon", alpha = 0.4, 
          size = 0.8) +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.87, 92.98), 
           ylim = c(56.03, 56.07),
           expand = FALSE)
```

</details>

::: {#fig-KRSK_graph .column-body-inset-right}

![](KRSK_graph.png){.lightbox}

–ì—Ä–∞—Ñ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥–æ—Ä–æ–¥–∞ –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∞, —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑–∞–Ω—ã –∑–¥–∞–Ω–∏—è –∏ —Å—Ç—Ä–æ–µ–Ω–∏—è
:::

## –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏

–ü–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É–∑–ª—ã, –∏–º–µ—é—â–∏–µ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –≤—Ö–æ–¥—è—â–µ–µ –∏ –æ–¥–Ω–æ –≤—ã—Ö–æ–¥—è—â–µ–µ —Ä–µ–±—Ä–æ. –î–ª—è —Ç–∞–∫–∏—Ö –∑–∞–¥–∞—á, –∫–∞–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π, —Ç–∞–∫–∏–µ —É–∑–ª—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Ç–æ—á–∫–∏, –æ—Ç–∫—É–¥–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω—ã —Ä–∞–∑–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤, –ª–∏–±–æ, –≤ –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∞—Ö, —ç—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –ª—é–±—ã–µ —É–∑–ª—ã —Ç–æ–ª—å–∫–æ —Å –¥–≤—É–º—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–Ω—ã–º–∏ —Ä–µ–±—Ä–∞–º–∏. –¢–∞–∫–æ–≥–æ —Ä–æ–¥–∞ —É–∑–ª—ã –º—ã –Ω–∞–∑–æ–≤–µ–º *–ø—Å–µ–≤–¥–æ—É–∑–ª–∞–º–∏*. –î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≥—Ä–∞—Ñ–∞ –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –∏—Ö —É–¥–∞–ª—è—é—Ç, –ø—Ä–æ–≤–æ–¥—è –ø—Ä–æ—Ü–µ–¥—É—Ä—É —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è. –§—É–Ω–∫—Ü–∏—è `to_spatial_smooth()` –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —Å–≥–ª–∞–∂–∏–≤–∞–µ—Ç –ø—Å–µ–≤–¥–æ—É–∑–ª—ã –∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≥–µ–æ–º–µ—Ç—Ä–∏–∏ —Å—Ç—Ä–æ–∫ –¥–≤—É—Ö –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö —Ä–µ–±–µ—Ä –≤–º–µ—Å—Ç–µ –≤ –Ω–æ–≤—É—é –≥–µ–æ–º–µ—Ç—Ä–∏—é –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –¢–∞–∫–∂–µ, —É—á—Ç–µ–º —Ç–∏–ø –¥–æ—Ä–æ–≥ –¥–ª—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–Ω—ã—Ö —Ä–µ–±–µ—Ä.

```{.r}
library(tidygraph)

smoothed_net <- convert(net, to_spatial_smooth, 
                        require_equal = "highway")
```

<details>
<summary>–ö–æ–¥: —Å–≥–ª–∞–∂–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏</summary>

```{.r}
# –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ
base_map + 
  # –∑–¥–∞–Ω–∏—è –∏ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è
  geom_sf(data = buildings, linewidth = 0.15) +
  # —Ä–µ–±—Ä–∞ –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(smoothed_net, "edges"), 
          col = "red", 
          linewidth = 0.7,
          alpha = 0.4) +
  # –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(smoothed_net, "nodes"), 
          col = "maroon", alpha = 0.4, 
          size = 0.8) +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.87, 92.98), 
           ylim = c(56.03, 56.07),
           expand = FALSE) + 
  theme_void()
```

</details>

::: {#fig-KRSK_graph .column-body-inset-right}

![](KRSK_smoothed_graph.png){.lightbox}

–°–≥–ª–∞–∂–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥–æ—Ä–æ–¥–∞ –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∞
:::

## –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏

–ú—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–µ–∑–∞—Ç—å –≥—Ä–∞—Ñ.

```{.r}
# –ø–æ–ª–∏–≥–æ–Ω –¥–ª—è –∫—Ä–æ–ø–∞
crop_polygon <- 
tibble(lon = c(92.87, 92.98), 
       lat = c(56.03, 56.07)) |>
  st_as_sf(coords = c("lon", "lat"), 
           crs = 4326) |>
  st_bbox() |>
  st_as_sfc()
```

```{.r}
# –∫—Ä–æ–ø –ø–æ –ø–æ–ª–∏–≥–æ–Ω—É
net_polygon_filtered <- st_filter(net, crop_polygon)
```

<details>
<summary>–ö–æ–¥: –ø—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏</summary>

```{.r}
my_epsilon = 0.01

# –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫—É
base_map + 
  # –∑–¥–∞–Ω–∏—è –∏ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è
  geom_sf(data = buildings, linewidth = 0.1) +
  # –≥—Ä–∞–Ω–∏—Ü–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞
  geom_sf(data = crop_polygon, 
          alpha = 0.2,
          linewidth = 0.8,
          color = "black") +
  # —Ä–µ–±—Ä–∞ –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(net_polygon_filtered, "edges"), 
          col = "red", alpha = 0.4) +
  # –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(net_polygon_filtered, "nodes"), 
          col = "maroon", alpha = 0.4, 
          size = 0.7) +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.87-my_epsilon, 92.98+my_epsilon), 
           ylim = c(56.03-my_epsilon/2, 56.07+my_epsilon/2),
           expand = FALSE) +
  theme_void()
```

</details>

::: {#fig-KRSK_polygon_filtered .column-body-inset-right}

![](KRSK_polygon_filtered.png){.lightbox}

–ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥–æ—Ä–æ–¥–∞ –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∞
:::

–ù–µ–º–Ω–æ–≥–æ –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Å–ª—É—á–∞–π –∫–∞—Å–∞–µ—Ç—Å—è —Ä–∞–π–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –°–∫–∞–∂–µ–º, –ø—É—Å—Ç—å –≥—Ä–∞—Ñ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ä–µ–≥–∏–æ–Ω–µ (—Ä–∞–π–æ–Ω–µ –≥–æ—Ä–æ–¥–∞ –∏ —Ç.–¥.).

```{.r}
# –∑–¥–µ—Å—å –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –≥–æ—Ä–æ–¥
my_place <- "Krasnojarsk Russia"

# –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ä–∞–π–æ–Ω–∞–º –≥–æ—Ä–æ–¥–∞ –∏–∑ OSM
districts_osm <- opq(my_place) |>
  add_osm_feature(key = "admin_level", value = 9) |>
  osmdata_sf() |>
  unname_osmdata_sf()
```

```{.r}
# –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞–π–æ–Ω–æ–≤ –≥–æ—Ä–æ–¥–∞
districts <- districts_osm %>% 
  .$osm_multipolygons |>
  dplyr::select(osm_id, name)

# –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Ä–∞–π–æ–Ω –≥–æ—Ä–æ–¥–∞
crop_region <- districts |>
  dplyr::filter(name == "–õ–µ–Ω–∏–Ω—Å–∫–∏–π —Ä–∞–π–æ–Ω")
```

```{.r}
# —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–∞–π–æ–Ω—É –≥–æ—Ä–æ–¥–∞
filtered_region <- st_filter(net, crop_region)
```

<details>
<summary>–ö–æ–¥: –ø—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞ –ø–æ —Ä–∞–π–æ–Ω—É –≥–æ—Ä–æ–¥–∞</summary>

```{.r}
# —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–∞–π–æ–Ω—É –≥–æ—Ä–æ–¥–∞
base_map + 
  # –∑–¥–∞–Ω–∏—è –∏ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è
  geom_sf(data = buildings,
          linewidth = 0.06,
          alpha = 0.7) +
  # –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞–π–æ–Ω–∞
  geom_sf(data = crop_region, 
          alpha = 0.2,
          linewidth = 0.8,
          color = "black") +
  # —Ä–µ–±—Ä–∞ –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(filtered_region, "edges"), 
          col = "red", 
          linewidth = 0.4,
          alpha = 0.3) +
  # –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(filtered_region, "nodes"), 
          col = "maroon", alpha = 0.35, 
          size = 0.3) +
  # –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
  coord_sf(xlim = c(92.93, 93.12), 
           ylim = c(55.97, 56.07),
           expand = FALSE) +
  theme_void()
```

</details>

::: {#fig-KRSK_crop_Leninsky .column-body-inset-right}

![](KRSK_crop_Leninsky.png){.lightbox}

–ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥–æ—Ä–æ–¥–∞ –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∞ –ø–æ —Ä–∞–π–æ–Ω—É
:::

# –°–µ—Ç–µ–≤–æ–π –∞–Ω–∞–ª–∏–∑

## –ü–æ–Ω—è—Ç–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ–Ω—è—Ç–∏–µ *—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ —É–∑–ª–∞* –≥—Ä–∞—Ñ–∞. –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–ª–∏ –±–ª–∏–∑–æ—Å—Ç–∏ –∫ —Ü–µ–Ω—Ç—Ä—É –≤ —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑–µ —Å–µ—Ç–µ–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–ª–∏—è—Ç–µ–ª—å–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö [–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏](https://ru.wikipedia.org/wiki/%D0%A6%D0%B5%D0%BD%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C){target="_blank"}. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏—è `centrality_betweenness()` –≤–≤–æ–¥–∏—Ç –ø–æ–Ω—è—Ç–∏–µ *—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ—Å—Ç–∏*, –∫–æ—Ç–æ—Ä–æ–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≥–µ–æ–¥–µ–∑–∏—á–µ—Å–∫–∏—Ö (–∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π), –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —á–µ—Ä–µ–∑ –≤–µ—Ä—à–∏–Ω—É (—Ä–µ–±—Ä–æ). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º –≤—ã–¥–µ–ª–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–∫–∏ (–¥–æ—Ä–æ–≥–∏) —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π –ø–æ—Ç–æ–∫.

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —É–∑–ª–∞ $u$ –≥—Ä–∞—Ñ–∞, –ø—É—Å—Ç—å $\sigma_{vw}(u)$ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç —á–∏—Å–ª–æ –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π –∏–∑ —É–∑–ª–∞ $v$ –≤ —É–∑–µ–ª $w$ –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —á–µ—Ä–µ–∑ –¥–∞–Ω–Ω—ã–π —É–∑–µ–ª $u$. –¢–æ–≥–¥–∞, –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–∞–∫
$$
B(u) = \sum_{v \not = w, v\not = u, w \not = u}
\frac{\sigma_{vw}(u)}{\sigma_{vw}},
$$
–≥–¥–µ $\sigma_{vw}$ -- –æ–±—â–µ–µ —á–∏—Å–ª–æ –≤—Å–µ—Ö –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π –∏–∑ —É–∑–ª–∞ $v$ –≤ —É–∑–µ–ª $w$.

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫—É—é "–ø–æ–¥—Ç–∞–±–ª–∏—Ü—É" –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤ *tidy*-–≤–µ—Ä—Å–∏–∏ –Ω–∞—à–µ–≥–æ –≥—Ä–∞—Ñ–∞ (—Å–æ—Å—Ç–æ—è—â–µ–≥–æ –∏–∑ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü), –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≥–ª–∞–≥–æ–ª `active` -- —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –ù–∞–π–¥–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å —É–∑–ª–æ–≤ –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

```{r}
#| message: false
#| warning: false

net_bc <- net |>
  activate("nodes") |>
  # —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ—Å—Ç–∏
  mutate(bc = centrality_betweenness()) |>
  # —Ä–∞–Ω–∂–∏—Ä—É–µ–º –∏–Ω–¥–µ–∫—Å
  # —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –Ω–∞–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –∫–∞—Ä—Ç–µ
  # —á—Ç–æ–±—ã —Ç–æ—á–∫–∏ —Å –±–æ–ª—å—à–∏–º –∏–Ω–¥–µ–∫—Å–æ–º –±—ã–ª–∏ –Ω–∞–≤–µ—Ä—Ö—É
  arrange(bc)
```

–í—ã–¥–µ–ª–∏–º —Ç–æ—á–∫—É —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏.

```{r}
#| message: false
#| warning: false

net_max_bc <- st_coordinates(net_bc) |>
  as_tibble() |>
  rename(lon = X, lat = Y) %>%
  cbind(., net_bc) |>
  as_tibble() |>
  slice_max(bc, n = 1) |>
  st_as_sf(coords = c("lon", "lat"), crs = 4326)
```

```{r}
net_max_bc
```


–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ –º—ã —Ç–∞–∫–∂–µ —Å–¥–µ–ª–∞–µ–º –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å —á–∞—Å—Ç—å –∫–∞—Ä—Ç—ã. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ `ggmagnify`, –Ω–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [–±–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://cidm-ph.github.io/ggmapinset/index.html){target="_blank"} `ggmapinset`.

```{.r}
library(ggmapinset)

# –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å –¥–ª—è –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Å–Ω–æ—Å–∫–∏
KRSK_inset <- configure_inset(
  centre = st_as_sfc(net_max_bc), 
  scale = 1.35,
  translation = c(0, 5.5), 
  radius = 1.5, 
  units = "km"
)
```

<details>
<summary>–ö–æ–¥: —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞</summary>

```{.r}
# —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞
base_map + 
  # –≤–µ—Ä—à–∏–Ω—ã
  geom_sf(data = st_as_sf(net_bc, "nodes"), 
          aes(color = bc / 10^6, 
              size = bc / 10^6, 
              alpha = bc / 10^6)) + 
  theme_void() +
  # *_inset: –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–Ω–æ—Å–∫–µ
  # —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ—Ä–æ–≥–∏
  geom_sf_inset(data = streets |>
                  dplyr::filter(highway_group == "large"),
                linewidth = 0.4,
                color = "grey30") +
  geom_sf_inset(data = streets |>
                  dplyr::filter(highway_group == "medium"),
                linewidth = 0.2,
                color = "grey35") +
  geom_sf_inset(data = streets |>
            dplyr::filter(highway_group == "small"),
          linewidth = 0.1,
          color = "grey40") +
  # –∂–µ–ª–µ–∑–Ω—ã–µ –¥–æ—Ä–æ–≥–∏
  geom_sf_inset(data = railways,
          color = "grey30",
          linewidth = 0.3,
          linetype = "dotdash",
          alpha = 0.6) +
  # –≤–µ—Ä—à–∏–Ω—ã
  geom_sf_inset(data = st_as_sf(net_bc, "nodes"), 
                aes(col = bc / 10^6, 
                    size = bc / 10^6, 
                    alpha = bc / 10^6)) +
  viridis::scale_color_viridis(option = "magma", 
                               direction = -1) +
  # —Ü–≤–µ—Ç –∏ —Ç–æ–ª—â–∏–Ω–∞ –ª–∏–Ω–∏–∏ —Å–Ω–æ—Å–∫–∏
  geom_inset_frame(linewidth = 0.8,
                   color = "black") +
  # –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf_inset(xlim = c(92.76, 92.99),
                 ylim = c(55.98, 56.09), 
                 inset = KRSK_inset) +
  # –ª–µ–≥–µ–Ω–¥–∞
  # –ª–µ–≥–µ–Ω–¥–∞
  labs(size = "bc", 
       color = "bc") +
  # tweak: —É–±–∏—Ä–∞–µ—Ç alpha –∏–∑ –ª–µ–≥–µ–Ω–¥—ã
  guides(alpha = "none")
```

</details>

::: {#fig-KRSK_nodes_centrlity .column-body-inset-right}

![](KRSK_nodes_centrlity.png){.lightbox}

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∞. –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–≤–µ–Ω $bc\cdot 10^6$ (—á–µ–º —Ç–µ–º–Ω–µ–µ –∏ –±–æ–ª—å—à–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∞ –≤–µ—Ä—à–∏–Ω–∞, —Ç–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è)
:::

::: {.callout-note appearance="simple"}
–ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–∫–∏ —Å –≤—ã—Å–æ–∫–∏–º –∏–Ω–¥–µ–∫—Å–æ–º, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —è–≤–ª—è—é—Ç—Å—è –≥–ª–∞–≤–Ω—ã–º–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏ –Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ–µ –Ω–∞–ª–∏—á–∏–µ –∑–∞—Ç–æ—Ä–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ —É –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–∫–∞ –ø—Ä–æ—Å–ø–µ–∫—Ç–∞ –°–≤–æ–±–æ–¥–Ω—ã–π –∏ —É–ª–∏—Ü—ã –ú–∞–µ—Ä—á–∞–∫–∞, —Ç–∞–∫–∂–µ –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–º–µ—é—Ç —Ä–∞–∑–≤—è–∑–∫–∏ —É–ª–∏—Ü –ë—Ä—è–Ω—Å–∫–∞—è, 2-—è –ë—Ä—è–Ω—Å–∫–∞—è, –ö–∞–ª–∏–Ω–∏–Ω–∞ –∏ –ú–∞–µ—Ä—á–∞–∫–∞, –∫—Ä–æ–º–µ —Ç–æ–≥–æ, –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —É —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ—Ä–æ–≥–∏ –Ω–∞ –º–æ—Å—Ç–∞—Ö –∏ –ø–æ–¥—ä–µ–∑–¥–∞—Ö –∫ –º–æ—Å—Ç–∞–º.
:::

–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–µ—Ç–µ–≤—É—é –ø—Ä–æ—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–±–µ—Ä –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏. –° –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `centrality_edge_betweenness()` –ø—Ä–∏—Å–≤–æ–∏–º –∫–∞–∂–¥–æ–º—É —Ä–µ–±—Ä—É –∏–Ω–¥–µ–∫—Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏. –û—Ç–º–µ—Ç–∏–º, —á—Ç–æ –∑–¥–µ—Å—å –º—ã –Ω–µ –¥–æ–ª–∂–Ω—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫—Ä–∞—Ç–Ω—ã–µ —Ä–µ–±—Ä–∞, –∏–Ω–∞—á–µ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É (—Å–º. [[Vertex and edge betweenness centrality](https://r.igraph.org/reference/betweenness.html){target="_blank"}]).

```{.r}
net_bc_edges <- as_sfnetwork(streets_lines) |>
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è
  st_transform(4326) |>
  activate("edges") |>
  filter(!edge_is_multiple()) |>
  filter(!edge_is_loop()) |>
  mutate(bc_edges = centrality_edge_betweenness()) |>
  arrange(bc_edges)
```

<details>
<summary>–ö–æ–¥: —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–±–µ—Ä –≥—Ä–∞—Ñ–∞</summary>

```{.r}
base_map + 
  # –∑–¥–∞–Ω–∏—è –∏ —Å—Ç—Ä–æ–µ–Ω–∏—è
  geom_sf(data = buildings, linewidth = 0.07) +
  # —Ä–µ–±—Ä–∞
  geom_sf(data = st_as_sf(net_bc_edges, "edges"), 
          aes(color = bc_edges / 10^4, 
              alpha = bc_edges / 10^4, 
              linewidth = bc_edges / 10^4)) +
  theme_void(base_size = 14) +
  # –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.820, 92.965),
           ylim = c(55.985, 56.040)) +
  viridis::scale_color_viridis(option = "inferno", 
                               direction = -1) +
  # –ª–µ–≥–µ–Ω–¥–∞
  labs(color = "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–±–µ—Ä –≥—Ä–∞—Ñ–∞ / 10 000") +
  # tweak: —É–±–∏—Ä–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –ª–µ–≥–µ–Ω–¥—ã
  guides(alpha = "none", linewidth = "none") +
  # –ª–µ–≥–µ–Ω–¥–∞: —Ü–≤–µ—Ç
  guides(color = guide_colorbar(title.position = 'top', 
                                title.hjust = 0.5,
                                barwidth = unit(14, 'lines'), 
                                barheight = unit(0.7, 'lines'))) +
  theme(legend.position = "top")
```

</details>

::: {#fig-KRSK_edges_centrlity .column-body-inset-right}

![](KRSK_edges_centrlity.png){.lightbox}

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–µ–±–µ—Ä –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∞. –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–º –±–æ–ª—å—à–µ, —á–µ–º —Ç–µ–º–Ω–µ–µ —Ü–≤–µ—Ç —Ä–µ–±—Ä–∞
:::

::: {.callout-note appearance="simple"}
–ú—ã –≤–∏–¥–∏–º, —á—Ç–æ –≤ —Å–ª—É—á–∞–µ –≤—ã—à–µ –Ω–∞–∏–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —É–ª–∏—Ü—ã –≥–æ—Ä–æ–¥–∞: –õ–µ–Ω–∏–Ω–∞, –ü–∞—Ä—Ç–∏–∑–∞–Ω–∞ –ñ–µ–ª–µ–∑–Ω—è–∫–∞, –®–∞—Ö—Ç–µ—Ä–æ–≤, –ø—Ä–æ—Å–ø–µ–∫—Ç –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π —Ä–∞–±–æ—á–∏–π, –∞ —Ç–∞–∫–∂–µ –º–æ—Å—Ç—ã, —Å–æ–µ–¥–∏–Ω—è—é—â–∏–µ –±–µ—Ä–µ–≥–∞ –≥–æ—Ä–æ–¥–∞. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —ç—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–µ —É–ª–∏—Ü—ã –≥–æ—Ä–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –≤ —á–∞—Å—ã –ø–∏–∫.
:::

## –°–≤—è–∑–Ω–æ—Å—Ç—å –≥—Ä–∞—Ñ–∞

–ì—Ä–∞—Ñ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π. –í —Å–≤—è–∑–∏ —Å —ç—Ç–∏–º –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏, –ø–æ—Å–∫–æ–ª—å–∫—É –∏–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ —É–∑–ª–∞ –º–æ–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å —Ç–æ–ª—å–∫–æ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π. –í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –≤–æ–∑–º–æ–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å —Å–µ—Ç—å –¥–æ –µ–µ —Å–∞–º–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ (–∏–ª–∏ —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö) –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞(–æ–≤), –ø—Ä–µ–∂–¥–µ —á–µ–º –≤—ã—á–∏—Å–ª—è—Ç—å –∫—Ä–∞—Ç—á–∞–π—à–∏–µ –ø—É—Ç–∏. –ù–∞–π–¥–µ–º —Å–∞–º—É—é –±–æ–ª—å—à—É—é —Å–≤—è–∑–Ω—É—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –Ω–∞—à–µ–≥–æ –≥—Ä–∞—Ñ–∞. –§—É–Ω–∫—Ü–∏—è `group_components()` –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –∫–∞–∂–¥–æ–º—É —É–∑–ª—É –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è, –ø—Ä–∏—á–µ–º 1 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–∞–º–æ–π –±–æ–ª—å—à–æ–π —Å–≤—è–∑–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–µ –≤ —Å–µ—Ç–∏, 2 -- –≤—Ç–æ—Ä–æ–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

::: {.callout-tip appearance="simple"}
–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ –æ–∫—Ä—É–≥–ª–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –≤ –ø—Ä–∏—Å—Ç—ã–∫–æ–≤–∫–µ –ª–∏–Ω–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –≤ [[Rounding coordinates](https://luukvdmeer.github.io/sfnetworks/articles/sfn02_preprocess_clean.html#rounding-coordinates){target="_blank"}] –∏–ª–∏ –≤ [[–¢.–ï. –°–∞–º—Å–æ–Ω–æ–≤](https://tsamsonov.github.io/r-geo-course/16-NetworkAnalysis.html#%D0%BF%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85){target="_blank"}]. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –º—ã –Ω–µ –ø—Ä–æ–≤–æ–¥–∏–ª–∏ –¥–∞–Ω–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –≤ —Å–≤—è–∑–∏ —Å —Ç–µ–º, —á—Ç–æ –≥—Ä–∞—Ñ –∏–º–µ–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à—É—é —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å.
:::

–ù–∞–π–¥–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞.

```{r}
# –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
with_graph(net, graph_component_count())
```

–í—ã–¥–µ–ª–∏–º –ø–µ—Ä–≤—É—é (—Å–∞–º—É—é –±–æ–ª—å—à—É—é) —Å–≤—è–∑–Ω—É—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –≥—Ä–∞—Ñ–∞ –∏ –∏–∑–æ–±—Ä–∞–∑–∏–º –µ–µ.

```{r}
# –≥–ª–∞–≤–Ω–∞—è —Å–≤—è–∑–Ω–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
net_connected_comp <- net |>
  activate("nodes") |>
  filter(group_components() == 1)

# —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Å–≤—è–∑–Ω–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
with_graph(net_connected_comp, graph_component_count())
```

<details>
<summary>–ö–æ–¥: –≥–ª–∞–≤–Ω–∞—è —Å–≤—è–∑–Ω–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏</summary>

```{.r}
base_map + 
  # –∑–¥–∞–Ω–∏—è –∏ —Å—Ç—Ä–æ–µ–Ω–∏—è
  geom_sf(data = buildings, linewidth = 0.07) +
  # —Ä–µ–±—Ä–∞
  geom_sf(data = st_as_sf(net, "edges"), 
          color = "blue",
          linewidth = 0.2,
          alpha = 0.6) +
  # –≤–µ—Ä—à–∏–Ω—ã
  geom_sf(data = st_as_sf(net, "nodes"), 
          color = "blue",
          size = 0.3,
          alpha = 0.6) +
  # —Ä–µ–±—Ä–∞
  geom_sf(data = st_as_sf(net_connected_comp, "edges"), 
          color = "red",
          linewidth = 0.5,
          alpha = 0.9) +
  # –≤–µ—Ä—à–∏–Ω—ã
  geom_sf(data = st_as_sf(net_connected_comp, "nodes"), 
          color = "red",
          size = 0.6,
          alpha = 0.9) +
  theme_void() +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.87, 92.98), 
           ylim = c(56.03, 56.07),
           expand = FALSE)
```

</details>

::: {#fig-KRSK_connected_component .column-body-inset-right}

![](KRSK_connected_component.png){.lightbox}

–ì–ª–∞–≤–Ω–∞—è —Å–≤—è–∑–Ω–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ (–≤—ã–¥–µ–ª–µ–Ω–∞ –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º)
:::

## –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞. –ù–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [–º–µ—Ç–æ–¥ –õ—É–≤–µ–Ω–∞](https://en.wikipedia.org/wiki/Louvain_method){target="_blank"} –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (–∏–ª–∏ –ø–æ-–¥—Ä—É–≥–æ–º—É *—Å–æ–æ–±—â–µ—Å—Ç–≤*). –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ —Å–º–µ–∂–Ω—ã—Ö –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ —Å–ª–µ–¥—É–µ—Ç –¥–∞—Ç—å –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—É—é –æ—Ü–µ–Ω–∫—É —Å–º–µ–∂–Ω—ã–º —Ä–∞–π–æ–Ω–∞–º –≥–æ—Ä–æ–¥–∞ –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏ –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–∫–æ–≤.

```{.r}
# —Ç–æ–ª—å–∫–æ –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ—ã
net_custered <- as_sfnetwork(streets_lines, directed = FALSE) |> 
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è
  st_transform(4326) |>
  activate("nodes") |> 
  mutate(comp = group_components()) |>
  dplyr::filter(comp == 1) |>
  mutate(louvain = as.factor(group_louvain()))
```

<details>
<summary>–ö–æ–¥: –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤</summary>

```{.r}
base_map + 
  # –∑–¥–∞–Ω–∏—è –∏ —Å—Ç—Ä–æ–µ–Ω–∏—è
  geom_sf(data = buildings, linewidth = 0.05) +
  # —Ä–µ–±—Ä–∞
  geom_sf(data = st_as_sf(net_custered, "edges"), 
          color = "grey60",
          linewidth = 0.5,
          alpha = 0.5) +
  # –≤–µ—Ä—à–∏–Ω—ã
  geom_sf(data = st_as_sf(net_custered, "nodes"), 
          aes(fill = louvain),
          size = 1.4,
          pch = 21,
          color = "grey20",
          linewidth = 0.01,
          alpha = 0.8) +
  theme_void() +
  viridis::scale_fill_viridis(discrete = TRUE,
                               option = "turbo") +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.80, 93.00), 
           ylim = c(56.00, 56.07),
           expand = FALSE) +
  theme(legend.position = "none")
```

</details>

::: {#fig-KRSK_clusters .column-body-inset-right}

![](KRSK_clusters.png){.lightbox}

–ö–ª–∞—Å—Ç–µ—Ä—ã –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å–≤—è–∑–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏
:::

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤ **R** –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://tidyclust.tidymodels.org/index.html){target="_blank"} `tidyclust` –∏–ª–∏ [–±–∏–±–ª–∏–æ—Ç–µ–∫–∏](https://spatialsample.tidymodels.org/index.html) `spatialsample`, –∫–æ—Ç–æ—Ä–∞—è —Å–ª—É–∂–∏—Ç –¥–ª—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ `tidymodels` –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Å –≤–æ–∑–º–æ–∂–Ω—ã–º —É—á–µ—Ç–æ–º –±—É—Ñ–µ—Ä–Ω—ã—Ö –∑–æ–Ω. –í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º [–º–µ—Ç–æ–¥ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏](https://ru.wikipedia.org/wiki/%D0%98%D0%B5%D1%80%D0%B0%D1%80%D1%85%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F){target="_blank"} –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

```{.r}
set.seed(123)
library(spatialsample)

# –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
h_clust <-
spatial_clustering_cv(st_as_sf(filtered_region, "nodes"), 
  v = 5, 
  cluster_function = "hclust") |> 
  autoplot(size = 0.8) 
```

<details>
<summary>–ö–æ–¥: –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è</summary>

```{.r}
# –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
h_clust <-
spatial_clustering_cv(st_as_sf(filtered_region, "nodes"), 
  v = 5, 
  cluster_function = "hclust") |> 
  autoplot(size = 0.8) +
  # –¥–æ—Ä–æ–∂–Ω–∞—è —Å–µ—Ç—å
  geom_sf(data = streets |>
            dplyr::filter(highway_group == "large"),
          linewidth = 0.4,
          color = "grey30") +
  geom_sf(data = streets |>
            dplyr::filter(highway_group == "medium"),
          linewidth = 0.2,
          color = "grey35") +
  geom_sf(data = streets |>
            dplyr::filter(highway_group == "small"),
          linewidth = 0.1,
          color = "grey40") +
  # –∂–µ–ª–µ–∑–Ω—ã–µ –¥–æ—Ä–æ–≥–∏
  geom_sf(data = railways,
          color = "grey30",
          linewidth = 0.3,
          linetype = "dotdash",
          alpha = 0.6) +
  # –≤–æ–¥–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
  geom_sf(data = water,
          fill = "steelblue",
          lwd = 0,
          alpha = 0.3) +
  # –∑–¥–∞–Ω–∏—è –∏ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è
  geom_sf(data = buildings,
          linewidth = 0.06,
          alpha = 0.7)

# –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
gg_clust + 
  # —Ä–µ–±—Ä–∞ –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(filtered_region, "edges"), 
          col = "black", 
          linewidth = 0.3,
          alpha = 0.3) +
  # –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞–π–æ–Ω–∞
  geom_sf(data = crop_region, 
          alpha = 0.2,
          linewidth = 0.8,
          color = "black") +
  # —Ü–≤–µ—Ç
  ggsci::scale_color_d3() +
  theme_void() +
  theme(legend.position = "none") +
  # –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
  coord_sf(xlim = c(92.93, 93.12), 
           ylim = c(55.97, 56.07),
           expand = FALSE)
```

</details>

::: {#fig-KRSK_hclust .column-body-inset-right}

![](KRSK_hclust.png){.lightbox}

–ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ (5 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤) –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `hclust`
:::


## –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ä–æ–¥—Å–∫–æ–π —É–ª–∏—á–Ω–æ–π —Å–µ—Ç–∏

–ë–æ–ª—å—à—É—é —Ä–æ–ª—å –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥–æ—Ä–æ–¥—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–≥—Ä–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Å–≤—è–∑–Ω–æ—Å—Ç—å, –Ω–æ –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ —É–ª–∏—á–Ω–æ–π —Å–µ—Ç–∏. –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —ç–Ω—Ç—Ä–æ–ø–∏—è —É–ª–∏—á–Ω–æ–π —Å–µ—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª–∞—Å—å –≤ —Ä–∞–±–æ—Ç–µ [[G. Boeing](https://appliednetsci.springeropen.com/articles/10.1007/s41109-019-0189-1){target="_blank"}] –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö *OpenStreetMap* –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ [OSMnx](https://github.com/gboeing/osmnx){target="_blank"} —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è **Python**. 

–§—É–Ω–∫—Ü–∏—è `edge_azimuth()` –≤—ã—á–∏—Å–ª—è–µ—Ç —É–≥–æ–ª –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ —Ç–æ—á–µ–∫, –∞ –∏–º–µ–Ω–Ω–æ: –º–µ–∂–¥—É –ø—Ä—è–º–æ–π –ª–∏–Ω–∏–µ–π –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ —Ä–µ–±—Ä–∞, —É–∫–∞–∑—ã–≤–∞—é—â–µ–π –Ω–∞ —Å–µ–≤–µ—Ä, –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –¥–æ –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏ —Ä–µ–±—Ä–∞.

```{r}
# –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∞–∑–∏–º—É—Ç–∞–ª—å–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
azimuth_net <- net |>
  activate("edges") |>
  morph(to_spatial_transformed, 4326) |>
  mutate(azimuth = edge_azimuth()) |>
  unmorph()
```

```{r}
#| message: false
#| warning: false

azimuth_net |>
  pull(azimuth) |> 
  as_tibble()
```

–ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞—Å—Ç—Ä–æ–π–∫–∏.

<details>
<summary>–ö–æ–¥: –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏</summary>

```{.r}
base_map + 
  # —Ä–µ–±—Ä–∞ –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(azimuth_net, "edges"), 
                   aes(color = as.numeric(azimuth)), 
                   alpha = 0.7,
          linewidth = 0.65) +
  # –≥—Ä–∞–¥–∏–µ–Ω—Ç
  scale_colour_gradient2(
    low = "#009593",
    mid = "white",
    high = "#D48444",
    midpoint = 0,
    name = "–∞–∑–∏–º—É—Ç–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (—Ä–∞–¥):") +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.87, 92.98), 
           ylim = c(56.03, 56.07),
           expand = FALSE) +
  theme_void() +
  # –ª–µ–≥–µ–Ω–¥–∞
  theme(legend.position = "bottom",
        legend.title = element_text(size = rel(1.2),
                                    family = "IBM Plex Sans"),
        legend.text = element_text(size = rel(1.2),
                                   family = "IBM Plex Sans")) +
  guides(color = guide_colorbar(title.position = 'top', 
                                title.hjust = 0.5,
                                barwidth = unit(17, 'lines'), 
                                barheight = unit(0.8, 'lines')))
```

</details>

::: {#fig-KRSK_azimuth .column-body-inset-right}

![](KRSK_azimuth.png){.lightbox}

–ê–∑–∏–º—É—Ç–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–ª–∏—Ü, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ø–æ –≥—Ä–∞—Ñ—É –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∞
:::

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ä–∞–±–æ—Ç–µ [[G. Boeing](https://appliednetsci.springeropen.com/articles/10.1007/s41109-019-0189-1){target="_blank"}] –ø–æ—Å—Ç—Ä–æ–∏–º –ø–æ–ª—è—Ä–Ω—É—é –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É, –æ—Ç–æ–±—Ä–∞—é—â—É—é –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é —É–ª–∏—Ü –≥–æ—Ä–æ–¥–∞, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ª—É—á—à–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞—Å—Ç—Ä–æ–π–∫–∏.

<details>
<summary>–ö–æ–¥: –ø–æ–ª—è—Ä–Ω–∞—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞</summary>

```{.r}
library(units)

azimuth_net |>
  pull(azimuth) |> 
  as_tibble() |> 
  mutate(value = round(value, 1)) |> 
  group_by(value) |> 
  summarise(count = n()) |> 
  ggplot(aes(x = as.numeric(value), y = count)) + 
  geom_bar(fill = "midnightblue", 
           stat = "identity") +
  theme_void() + 
  labs(x = "", y = "") +
  coord_polar()
```

</details>

::: {#fig-KRSK_polar_histogram}

![](KRSK_polar_histogram.png){width=50% fig-align="center"}

–ü–æ–ª—è—Ä–Ω–∞—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é —É–ª–∏—Ü –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –≥. –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∞
:::

::: {.callout-note appearance="simple"}
–ü–æ—Å–∫–æ–ª—å–∫—É –º–Ω–æ–≥–∏–µ –Ω–∞—Å–µ–ª–µ–Ω–Ω—ã–µ –ø—É–Ω–∫—Ç—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –Ω–∞ –±–µ—Ä–µ–≥–∞—Ö —Ä–µ–∫, —É–ª–∏—Ü—ã —Ç–∞–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤, –∫–∞–∫ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤–¥–æ–ª—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫–∏ –∏ –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ –∏–º. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –º–æ–≥—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Å—Ç—Ä–æ–π–∫–∏.
:::

## –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–æ–Ω —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

–û–¥–∏–Ω –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏—Ö –Ω–∞—Å –≤–æ–ø—Ä–æ—Å–æ–≤ -- –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ *–∑–æ–Ω —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏* –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Ç.–µ. –æ–±–ª–∞—Å—Ç–µ–π, –≤–∫–ª—é—á–∞—é—â–∏—Ö –≤—Å–µ —Ç–æ—á–∫–∏ –æ—Ç –∑–∞–¥–∞–Ω–Ω–æ–π, –≤ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å –Ω–µ –±–æ–ª–µ–µ —á–µ–º –∑–∞ –æ—Ç–≤–µ–¥–µ–Ω–Ω—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏, –¥–≤–∏–≥–∞—è—Å—å —Å —É—á–µ—Ç–æ–º —Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –ì—Ä–∞–Ω–∏—Ü—ã —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞ –∑–æ–Ω –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è *–∏–∑–æ—Ö—Ä–æ–Ω–∞–º–∏*.

–î–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —è–≤–ª—è–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø–æ–∂–∞—Ä–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞—Å–µ–ª–µ–Ω–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏ –∑–æ–Ω —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å —Ü–µ–Ω—Ç—Ä–æ–º, –Ω–∞—Ö–æ–¥—è—â–µ–º—Å—è –≤ –ø–æ–∂–∞—Ä–Ω–æ-—Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º. –ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ –≤—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è –ø–µ—Ä–≤–æ–≥–æ –ø–æ–∂–∞—Ä–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫ –º–µ—Å—Ç—É –≤—ã–∑–æ–≤–∞ –≤ –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –Ω–∞—Å–µ–ª–µ–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–∞—Ö –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 10 –º–∏–Ω—É—Ç, –≤ —Å–µ–ª—å—Å–∫–∏—Ö –Ω–∞—Å–µ–ª–µ–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–∞—Ö 20 –º–∏–Ω—É—Ç (—Å–º.  [[–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Ä–µ–≥–ª–∞–º–µ–Ω—Ç –æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –ø–æ–∂–∞—Ä–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](https://www.consultant.ru/document/cons_doc_LAW_78699/37485e28ef895554b68d6a69abb5fe5ad3a1f5e6/){target="_blank"}]). –ù–∞–∑–æ–≤–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–±–ª–∞—Å—Ç–∏ *–æ–±–ª–∞—Å—Ç—è–º–∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è*.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∏–ø—ã —Ä–µ–±–µ—Ä –≥—Ä–∞—Ñ–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–æ–≤ –¥–æ—Ä–æ–≥.

```{r}
types <- net_connected_comp |>
  activate("edges") |>
  pull(highway) |>
  unique()

types
```

–î–∞–ª–µ–µ –º—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–ø–∏—Å–∞—Ç—å –∫–∞–∂–¥–æ–º—É *OpenStreetMap*-—Ç–∏–ø—É –¥–æ—Ä–æ–≥ —Å–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ –Ω–µ–º—É, –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–ª–æ–∂–µ–Ω–æ –≤ [–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ—Ä–æ–≥ –≤ –†–æ—Å—Å–∏–∏](https://wiki.openstreetmap.org/wiki/RU:Highway_classification){target="_blank"}. –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∑–æ–Ω –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –≤—ã–±–æ—Ä–∞ —Å–∫–æ—Ä–æ—Å—Ç–µ–π. –û—Ç–º–µ—Ç–∏–º, —á—Ç–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–∫–µ—Ä–æ–≤, –ø–æ–∑–≤–æ–ª—è—â–∏—Ö –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è, –ª–∏–±–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±–æ–±—â–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–≥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫, –≤—Ä–µ–º–µ–Ω–∏ –≥–æ–¥–∞ –∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤. –°–∫–æ—Ä–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏, –∞ —Ç–∞–∫–∂–µ –±–∞–∑–∏—Ä—É—è—Å—å –Ω–∞ [—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö](https://wiki.openstreetmap.org/wiki/Default_speed_limits){target="_blank"} –∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏. 

|   | –¢–∏–ø—ã –¥–æ—Ä–æ–≥                                                      | –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ—Ä–æ–≥ –≤ –†–æ—Å—Å–∏–∏                                           | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –¥–æ—Ä–æ–≥–∏ |
|---|-----------------------------------------------------------------|------------------------------------------------------------------------|----------------------------------------------------|
| 1 | –ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ –¥–æ—Ä–æ–≥–∏ –æ–±—Ä–∞–∑—É—é—â–∏–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—É—é —Å–µ—Ç—å | *motorway*, *trunk*, *primary*, *secondary*, *tertiary*, *unclassified*            | 40 –∫–º/—á                                            |
| 2 | –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ –¥–æ—Ä–æ–≥–∏                            | *motorway_link*, *trunk_link*, *primary_link*, *secondary_link*, *tertiary_link* | 30 –∫–º/—á                                            |
| 3 | –ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ –¥–æ—Ä–æ–≥–∏ –≤ –∂–∏–ª—ã—Ö –∑–æ–Ω–∞—Ö –∏ –∂–∏–ª—ã–µ —É–ª–∏—Ü—ã                | *residential*, *living_street*                                             | 20 –∫–º/—á                                            |
| 4 | –°–ª—É–∂–µ–±–Ω—ã–µ –¥–æ—Ä–æ–≥–∏                                                | *service*, *track*                                                         | 20 –∫–º/—á                                            |

: –ü—Ä–∏–º–µ—Ä –≤—ã–±–æ—Ä–∞ —Å–∫–æ—Ä–æ—Å—Ç–µ–π –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç–∏–ø–∞–º –¥–æ—Ä–æ–≥ {#tbl-speed}

–ó–∞–¥–∞–¥–∏–º —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç–∏–ø–∞–º –¥–æ—Ä–æ–≥. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ –º/—Å. –¢–∞–∫–∂–µ, –Ω–∞–π–¥–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –≤—Ä–µ–º—è –¥–≤–∏–∂–µ–Ω–∏—è (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö) –ø–æ –∫–∞–∂–¥–æ–º—É —É—á–∞—Å—Ç–∫—É –¥–æ—Ä–æ–≥. 

::: {.callout-note appearance="simple"}
–û—Ç–º–µ—Ç–∏–º, —á—Ç–æ –ø–æ–¥—Ö–æ–¥ —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–µ–π –¥–≤–∏–∂–µ–Ω–∏—è, —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ç–æ—á–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è.
:::

–í—ã–±–µ—Ä–µ–º –∑–Ω–∞—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–µ–π –¥–≤–∏–∂–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–æ–≤ –¥–æ—Ä–æ–≥. –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –º—ã –Ω–µ —Å–º–æ–∂–µ–º –ø–æ–ø–∞—Å—Ç—å –∏–∑ –æ–¥–Ω–æ–≥–æ —É–∑–ª–∞ –≤ –¥—Ä—É–≥–æ–π, –Ω–∞—Ö–æ–¥—è—â–∏–π—Å—è –≤ –¥—Ä—É–≥–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ, –æ–≥—Ä–∞–Ω–∏—á–∏–º—Å—è –ª–∏—à—å –Ω–∞–∏–±–æ–ª—å—à–µ–π —Å–≤—è–∑–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–π –≥—Ä–∞—Ñ–∞, –Ω–∞–π–¥–µ–Ω–Ω–æ–π –≤—ã—à–µ.

<details>
<summary>–ö–æ–¥: —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è</summary>

```{.r}
net_speed <- 
  net_connected_comp |>
  activate("edges") |>
  mutate(weight = edge_length()) |>
  group_by(highway) |>
  # —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ –∫–º/—á
  mutate(
    speed_km_h = case_when(
      highway %in% c("motorway", "trunk", "primary", 
                     "secondary", "tertiary", 
                     "unclassified") ~ 40,
      highway %in% c("motorway_link", "trunk_link",
                     "primary_link", "secondary_link",
                     "tertiary_link") ~ 30,
      highway %in% c("residential", "living_street") ~ 20,
      highway %in% c("service", "track") ~ 20
    )
  ) |>
  # –ø–µ—Ä–µ—Å—á–µ—Ç –≤ –º/—Å
  mutate(speed = speed_km_h / 3.6) |>
  mutate(speed = units::set_units(speed, "m/s")) |>
  mutate(time = weight / speed) |>
  ungroup()

net_speed <- activate(net_speed, "nodes")
```

</details>

–í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–ø—Ä–∞–≤–Ω–æ–π —Ç–æ—á–∫–∏ –≤—ã–±–µ—Ä–µ–º —Ü–µ–Ω—Ç—Ä–æ–∏–¥ –≥—Ä–∞—Ñ–∞.

```{.r}
net_centroid <- net_speed |>
  activate("nodes") |>
  st_geometry() |>
  st_combine() |>
  st_centroid() |> 
  st_transform(4326)
```

–ù–∞–π–¥–µ–º –º–∞—Ç—Ä–∏—Ü—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –≥—Ä–∞—Ñ–∞, –≥–¥–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤–µ—Å–æ–≤ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –¥–≤–∏–∂–µ–Ω–∏—è.

```{.r}
cost_matrix_centroid <-
st_network_cost(net_speed, 
                # –±–ª–∏–∂–∞–π—à–∏–π –æ–±—ä–µ–∫—Ç –∫ —Ü–µ–Ω—Ç—Ä–æ–∏–¥—É –≥—Ä–∞—Ñ–∞
                from = st_nearest_feature(net_centroid,
                                          net_speed),
                weights = "time")
```

–¢–µ–ø–µ—Ä—å –ø–æ—Å—Ç—Ä–æ–∏–º –ø–æ–¥–≥—Ä–∞—Ñ-–∏–∑–æ—Ö—Ä–æ–Ω—É, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â—É—é –≤—Ä–µ–º—è –¥–≤–∏–∂–µ–Ω–∏—è —Ä–∞–≤–Ω–æ–µ 10 –º–∏–Ω—É—Ç–∞–º. 

```{.r}
net_isochrone <-
net_speed |>
  activate("nodes") |>
  mutate(cost = cost_matrix_centroid |> 
           t() %>% 
           as.vector(.),
         # –ø–µ—Ä–µ–≤–æ–¥ —Å–µ–∫—É–Ω–¥ –≤ –º–∏–Ω—É—Ç—ã
         cost = cost / 60) |>
  tidygraph::filter(cost <= 10)
```

–ù–∞–π–¥–µ–º –≤—ã–ø—É–∫–ª—É—é –æ–±–æ–ª–æ—á–∫—É –∏–∑–æ—Ö—Ä–æ–Ω—ã.

```{.r}
isochrone_conv_hull <- net_isochrone |>
  st_geometry() |>
  st_combine() |>
  st_convex_hull()
```

–ò–∑–æ–±—Ä–∞–∑–∏–º –∏–∑–æ—Ö—Ä–æ–Ω—É –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â—É—é –æ–±–ª–∞—Å—Ç—å.

<details>
<summary>–ö–æ–¥: –∏–∑–æ—Ö—Ä–æ–Ω–∞</summary>

```{.r}
base_map + 
  # –∑–¥–∞–Ω–∏—è –∏ —Å—Ç—Ä–æ–µ–Ω–∏—è
  geom_sf(data = buildings, linewidth = 0.05) +
  # –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(net_isochrone, "nodes"), 
          aes(color = cost),
          alpha = 0.9,
          size = 1.7) +
  # —Ü–µ–Ω—Ç—Ä–æ–∏–¥ –≥—Ä–∞—Ñ–∞
  geom_sf(data = net_centroid, 
          color = "red", 
          alpha = 1, 
          shape = 8, 
          size = 4.5, 
          stroke = 1.2) +
  # –≤—ã–ø—É–∫–ª–∞—è –æ–±–æ–ª–æ—á–∫–∞ –∏–∑–æ—Ö—Ä–æ–Ω—ã
  geom_sf(data = isochrone_conv_hull, alpha = 0.1, 
          color = "midnightblue",
          linewidth = 0.6) +
  # —Ä–µ–±—Ä–∞ –≥—Ä–∞—Ñ–∞
  geom_sf(data = st_as_sf(net_isochrone, "edges"), 
          alpha = 0.5,
          color = "black",
          linewidth = 0.15) +
  viridis::scale_color_viridis(direction = -1) +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.831, 92.949), 
           ylim = c(55.996, 56.07),
           expand = FALSE) +
  theme_void() +
  theme(legend.position = "none")
```

</details>

::: {#fig-KRSK_isochrone .column-body-inset-right}

![](KRSK_isochrone.png){.lightbox}

–ü—Ä–∏–º–µ—Ä –∏–∑–æ—Ö—Ä–æ–Ω—ã, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–π 10-–º–∏–Ω—É—Ç–Ω—É—é –æ–±–ª–∞—Å—Ç—å –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å–≤—è–∑–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏. –¶–≤–µ—Ç –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–¥–∞–ª–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–æ—á–∫–∏ (—á–µ–º —Ç–µ–º–Ω–µ–µ, —Ç–µ–º –¥–∞–ª—å—à–µ –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏)
:::

–ò–¥–µ–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏, –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏ –∫ –∏–∑—É—á–µ–Ω–∏—é –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫. –ü—É—Å—Ç—å —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã —Ä–∞–π–æ–Ω–æ–≤ –≥–æ—Ä–æ–¥–∞ —è–≤–ª—è—é—Ç—Å—è –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –ø—É–Ω–∫—Ç–∞–º–∏ (—É—Å–ª–æ–≤–Ω—ã–º–∏ –ø–æ–∂–∞—Ä–Ω—ã–º–∏ —á–∞—Å—Ç—è–º–∏ -- –ü–°–ß).

```{r}
#| echo: false
#| include: false
fire_stations <-
  tribble(
    ~name, ~c_lon, ~c_lat,
    "–ü–°–ß-1", 92.82686, 56.01383,
    "–ü–°–ß-2", 92.96615, 55.98596,
    "–ü–°–ß-3", 93.02779, 56.02276,
    "–ü–°–ß-4", 92.73413, 56.01672,
    "–ü–°–ß-5", 92.84575, 55.96372,
    "–ü–°–ß-6", 92.97927, 56.07533,
    "–ü–°–ß-7", 92.88060, 56.04314
  )

# CRS (coordinate reference system) –ø—Ä–æ–µ–∫—Ü–∏—è –≤ EPSG:4326
fire_stations_sf <- fire_stations |>
  st_as_sf(coords = c("c_lon", "c_lat"), 
           crs = 4326)  
```

```{r}
fire_stations_sf
```

–ù–∞–π–¥–µ–º —É–∑–ª—ã –≥—Ä–∞—Ñ–∞, –±–ª–∏–∂–∞–π—à–∏–µ –∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ç–æ—á–∫–∞–º, –ø–æ–∏—Å–∫ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –±—É–¥–µ–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –∏–∑ –Ω–∏—Ö.

```{.r}
fire_stations_near_points <-
  net_speed |>
  activate("nodes") |>
  st_as_sf() |>
  # –±–ª–∏–∂–∞–π—à–∏–µ —Ç–æ—á–∫–∏ –≥—Ä–∞—Ñ–∞ –∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–º
  slice(st_nearest_feature(fire_stations_sf,
                           net_speed)) |>
  mutate(lon = st_coordinates(geometry)[,1],
         lat = st_coordinates(geometry)[,2],
         name = c(paste("–ü–°–ß", 1:7, sep = "-")))
```

–î–∞–ª–µ–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ –≤—Å–µ –∑–¥–∞–Ω–∏—è, –∞ —Ç–æ–ª—å–∫–æ –º–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–µ –∂–∏–ª—ã–µ –¥–æ–º–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—é `apartments` –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `building` (—Å–º. [[–û–±—ä–µ–∫—Ç—ã –∫–∞—Ä—Ç—ã OpenSteetMap](https://wiki.openstreetmap.org/wiki/RU:%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B_%D0%BA%D0%B0%D1%80%D1%82%D1%8B){target="_blank"}]).

```{.r}
apartments <- buildings |>
  as_tibble() |>
  filter(building == "apartments") |>
  mutate(apartm_id = row_number()) |>
  st_sf()
```

–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –≤–¥–æ–ª—å –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã –∑–¥–∞–Ω–∏–π.

```{.r}
apartments_centroids <- apartments |>
  st_geometry() %>% 
  st_centroid(.) |>
  as_tibble() |>
  mutate(apartm_id = row_number()) |>
  st_sf()
```

–¢–µ–ø–µ—Ä—å –Ω–∞–π–¥–µ–º *–º–∞—Ç—Ä–∏—Ü—É —Å—Ç–æ–∏–º–æ—Å—Ç–∏* (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π) –æ—Ç –±–ª–∏–∂–∞–π—à–∏—Ö –∫ –ø–æ–∂–∞—Ä–Ω—ã–º —á–∞—Å—Ç—è–º —É–∑–ª–æ–≤ –¥–æ –±–ª–∏–∂–∞–π—à–∏—Ö —É–∑–ª–æ–≤ –∫ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞–º –∑–¥–∞–Ω–∏–π.

```{.r}
cost_matrix_apartments <-
  st_network_cost(net_speed, 
                  # –±–ª–∏–∂–∞–π—à–∏–µ —É–∑–ª—ã –∫ –ø–æ–∂–∞—Ä–Ω—ã–º —á–∞—Å—Ç—è–º
                  from = st_nearest_feature(fire_stations_sf,
                                            net_speed),
                  # –±–ª–∏–∂–∞–π—à–∏–µ —É–∑–ª—ã –∫ —Ü–µ–Ω—Ç—Ä–æ–∏–¥—É –≥—Ä–∞—Ñ–∞
                  to = st_nearest_feature(apartments_centroids,
                                          net_speed),
                  weights = "time")
```

–û—Ç–¥–µ–ª—å–Ω–æ –ø–æ–ª—É—á–∏–º –≤–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –æ—Ç —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤ –∑–¥–∞–Ω–∏–π –¥–æ *–±–ª–∏–∂–∞–π—à–µ–π –ø–æ–∂–∞—Ä–Ω–æ–π —á–∞—Å—Ç–∏*.

```{.r}
cost_vector_apartments <-
  cost_matrix_apartments |>
  as_tibble() |>
  summarise(across(where(is.numeric), min)) |>
  t() %>% 
  as.vector(.) |>
  as_tibble()
```

–î–æ–±–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å–Ω–∞—á–∞–ª–∞ –∫ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞–º –∑–¥–∞–Ω–∏–π.

```{.r}
apartments_cost <-
apartments_centroids |>
  as_tibble() |>
  mutate(cost = cost_vector_apartments$value,
         # –ø–µ—Ä–µ–≤–æ–¥ —Å–µ–∫—É–Ω–¥ –≤ –º–∏–Ω—É—Ç—ã
         cost = cost / 60) |>
  filter(cost < Inf) |>
  st_sf()
```

–°–æ–µ–¥–∏–Ω–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏–±—ã—Ç–∏—è –∫ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞–º –∑–¥–∞–Ω–∏–π —Å –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –∏ –æ—Å—Ç–∞–≤–∏–º —Ç–æ–ª—å–∫–æ –∑–¥–∞–Ω–∏—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –≥—Ä–∞–Ω–∏—Ü.

```{.r}
apartments_buildings_cost <- 
  left_join(st_drop_geometry(apartments_cost), 
            apartments) |>
  st_sf() |>
  st_intersection(boundary_KRSK)
```

–ü–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–æ—Ö—Ä–æ–Ω—ã, –º—ã –ø–æ—Å—Ç—Ä–æ–∏–º —Ä—è–¥ –≥—Ä–∞—Ñ–∏–∫–æ–≤. –°–Ω–∞—á–∞–ª–∞ –Ω–∞–π–¥–µ–º –≤—Ä–µ–º—è, –∑–∞ –∫–æ—Ç–æ—Ä–æ–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –º–∞—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –æ–Ω–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ 7 –º–∏–Ω—É—Ç.

```{.r}
max_row <- which.max(density(as_tibble(net_fire_stations)$cost)$y)
max_density <- density(as_tibble(net_fire_stations)$cost)$x[max_row]
```

–ò–∑–æ–±—Ä–∞–∑–∏–º –≥—Ä–∞—Ñ–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞ (–æ–±—ä–µ–∫—Ç–æ–≤), –¥–æ—Å—Ç–∏–∂–∏–º—ã—Ö –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è.

<details>
<summary>–ö–æ–¥: –≥—Ä–∞—Ñ–∏–∫ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏</summary>

```{.r}
# –≥—Ä–∞—Ñ–∏–∫ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
apartments_cost |>
  as_tibble() |>
  ggplot(aes(x = cost)) + 
  geom_density() +
  geom_vline(xintercept = max_density, 
             color = "red",
             linetype = "dashed",
             linewidth = 0.5) +
  scale_x_continuous(labels = function(x) str_c(x, ' –º–∏–Ω'),
                     breaks = seq(0, 50, by = 5)) +
  labs(x = "", y = "") +
  hrbrthemes::theme_ipsum()
```

</details>

::: {#fig-KRSK_density .column-body-inset-right}

![](KRSK_density.png)

–ì—Ä–∞—Ñ–∏–∫ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ—Å—Ç–∏–∂–∏–º—ã –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è. –ú–∞–∫—Å–∏–º—É–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—é 7,1 –º–∏–Ω—É—Ç—ã
:::

–î—Ä—É–≥–æ–π, –±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–π –¥–ª—è –Ω–∞—Å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å, -- —ç—Ç–æ *—Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏* $F(t)$, –∫–æ—Ç–æ—Ä–∞—è –≤ —Ç–æ—á–∫–µ $t_0$ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–ª—é (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ) —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–∏), –¥–æ—Å—Ç–∏–∂–∏–º—ã—Ö –∑–∞ –≤—Ä–µ–º—è $t < t_0$. –° –ø–æ–º–æ—â—å—é –¥–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã –∑–∞ –≤—Ä–µ–º—è $t$ –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ $a < t < b$ –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü—É $F(b) - F(a)$.

<details>
<summary>–ö–æ–¥: —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏</summary>

```{.r}
# —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏
apartments_cost |>
  as_tibble() |>
  ggplot(aes(x = cost)) + 
  stat_ecdf(geom = "step") + 
  geom_vline(xintercept = 10, 
             color = "red",
             linetype = "dashed",
             linewidth = 0.5) +
  scale_y_continuous(labels = scales::percent) +
  scale_x_continuous(labels = function(x) str_c(x, ' –º–∏–Ω'),
                     breaks = seq(0, 50, by = 5)) +
  labs(x = "", y = "") +
  hrbrthemes::theme_ipsum()
```

</details>

::: {#fig-KRSK_function .column-body-inset-right}

![](KRSK_function.png)

–ì—Ä–∞—Ñ–∏–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏. –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –∑–∞ 10 –º–∏–Ω—É—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ 75% —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞
:::

–ò–∑–æ–±—Ä–∞–∑–∏–º —Ü–≤–µ—Ç–æ–º –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç—å –∑–¥–∞–Ω–∏–π –∏–∑ –ü–°–ß.

<details>
<summary>–ö–æ–¥: —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã—Ö –∂–∏–ª—ã—Ö –¥–æ–º–æ–≤</summary>

```{.r}
base_map +
  # –∑–¥–∞–Ω–∏—è –∏ —Å—Ç—Ä–æ–µ–Ω–∏—è
  geom_sf(data = buildings, 
          linewidth = 0.03) +
  # –º–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–µ –∂–∏–ª—ã–µ –¥–æ–º–∞
  geom_sf(data = apartments_buildings_cost, 
          linewidth = 0.5, 
          aes(fill = cost, color = cost)) +
  # —Ç–æ—á–∫–∏ —Å –ü–°–ß
  geom_sf(data = st_sf(fire_stations_near_points),
          color = "black",
          alpha = 0.8, 
          shape = 8, 
          size = 3.5, 
          stroke = 1.2) +
  # –º–∞—Ä–∫–µ—Ä—ã
  ggrepel::geom_label_repel(data = fire_stations_near_points, 
                            aes(lon, lat, label = name), 
                            fontface = "bold",
                            box.padding = 0.7,
                            size = 4, 
                            alpha = 0.8) +
  # —Ü–≤–µ—Ç –∑–¥–∞–Ω–∏–π                          
  viridis::scale_fill_viridis(option = "viridis",
                          direction = -1) +
  viridis::scale_color_viridis(option = "viridis",
                           direction = -1) +
  theme_void() +
  theme(legend.position = "none") +
  # –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —á–∞—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
  coord_sf(xlim = c(92.79, 92.94), 
           ylim = c(55.98, 56.058),
           expand = FALSE)
```

</details>

::: {#fig-KRSK_sfnetworks .column-body-inset-right}

![](KRSK_sfnetworks.png){.lightbox}

–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã—Ö –∂–∏–ª—ã—Ö –¥–æ–º–æ–≤ –∏–∑ —É—Å–ª–æ–≤–Ω—ã—Ö –ø–æ–∂–∞—Ä–Ω–æ-—Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π. –û—Ç—Ç–µ–Ω–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏–±—ã—Ç–∏—è (—á–µ–º —Ç–µ–º–Ω–µ–µ, —Ç–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º—è –ø—Ä–∏–±—ã—Ç–∏—è)
:::


# –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ —Ä–∞–±–æ—Ç—É —Å –≥—Ä–∞—Ñ–æ–º –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `sfnetworks` –≤ **R**, –≤–∫–ª—é—á–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ç–ø–æ—Ä—Ç–Ω–æ–π —Å–µ—Ç–∏ –∏–∑ *OpenStreetMap* –≤ –≥—Ä–∞—Ñ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏ –∏ –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏. –¢–∞–∫–∂–µ, –º—ã –ø—Ä–∏–º–µ–Ω–∏–ª–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–ø–ø–∞—Ä–∞—Ç –∫ –ø–æ–ª—É—á–µ–Ω–∏—é –∑–æ–Ω —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ –∏–∑–æ—Ö—Ä–æ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥—Ä–∞—Ñ–æ–≤. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∑–∞–∫–ª—é—á–∞—é—Ç—Å—è –≤ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∞–º–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ API-—Å–µ—Ä–≤–∏—Å–∞,  –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–æ—Ä–æ—Å—Ç–µ–π –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç–∏–ø–∞–º –¥–æ—Ä–æ–≥ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–ø–ø–∞—Ä–∞—Ç–∞ —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤ –∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–º –∑–∞–¥–∞—á–∞–º.

::: {.column-margin}

<head>
  <!-- add the button style & script -->
  <link rel="stylesheet" href="../../../dist/applause-button.css" />
  <script src="../../../dist/applause-button.js"></script>
</head>
<body>
  <!-- add the button! -->
  <applause-button style="width: 58px; height: 58px;"/>
</body>

:::

–°–¥–µ–ª–∞–µ–º –Ω–µ–±–æ–ª—å—à–æ–π –æ–±–∑–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫ **R** –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã –ø—Ä–∏ —Å–µ—Ç–µ–≤–æ–º –∞–Ω–∞–ª–∏–∑–µ.

## –ü–æ–ª—É—á–µ–Ω–∏–µ *OpenStreetMap*-–¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö *OpenStreetMap*: 

- [osmdata](https://cran.r-project.org/web/packages/osmdata/vignettes/osmdata.html){target="_blank"} —Å–ª—É–∂–∏—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ *OpenStreetMap*; 

- [osrm](https://github.com/riatelab/osrm){target="_blank"} -- **R**-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ [Open Source Routing Machine](https://project-osrm.org/){target="_blank"}; 

- [osmextract](https://docs.ropensci.org/osmextract/){target="_blank"} –∑–∞–≥—Ä—É–∂–∞–µ—Ç, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –æ–±—ä–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ *OpenStreetMap* –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö [—Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤](https://docs.ropensci.org/osmextract/articles/providers.html){target="_blank"}, –Ω–∞–ø—Ä–∏–º–µ—Ä, [Geofabrik GmbH](https://download.geofabrik.de/){target="_blank"} –∏ [bbbike](https://download.bbbike.org/osm/){target="_blank"};

- [osmplotr](https://docs.ropensci.org/osmplotr/){target="_blank"} -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è –¥–∞–Ω–Ω—ã–µ *OpenStreetMap* –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç —Å —à–∏—Ä–æ–∫–∏–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

## –°–µ—Ç–µ–≤–æ–π –∞–Ω–∞–ª–∏–∑

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∞–º–∏ –¥–æ—Ä–æ–∂–Ω—ã—Ö —Å–µ—Ç–µ–π –∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏: 

- [sfnetwork](https://luukvdmeer.github.io/sfnetworks/index.html){target="_blank"} -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—è–º–∏ –∫–∞–∫ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≥—Ä–∞—Ñ–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ [sf](https://r-spatial.github.io/sf/){target="_blank"} –¥–ª—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ [tidygraph](https://tidygraph.data-imaginist.com/){target="_blank"} –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∞–º–∏; 

- [spNetwork](https://jeremygelb.github.io/spNetwork/index.html){target="_blank"} -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–µ—Ç–µ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞; 

- [cppRouting](https://github.com/vlarmet/cppRouting){target="_blank"} -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (–∫—Ä–∞—Ç—á–∞–π—à–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, –∏–∑–æ—Ö—Ä–æ–Ω—ã) —Å –±–æ–ª—å—à–∏–º–∏ –≥—Ä–∞—Ñ–∞–º–∏ –¥–æ—Ä–æ–≥ (–≤ –º–∞—Å—à—Ç–∞–±–µ —Å—Ç—Ä–∞–Ω—ã), —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∑–∞ —Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è;

- [dodgr](https://github.com/UrbanAnalyst/dodgr){target="_blank"} -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –∏ –Ω–∞ –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∞—Ö, –¥–ª—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ –≤ —Å–µ—Ç—è—Ö, –≤—ã—Å–æ–∫–æ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —É–ª–∏—á–Ω—ã–µ —Å–µ—Ç–∏ (–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏ —Å —É—á–µ—Ç–æ–º —É–∫–ª–æ–Ω–∞, —É–≥–ª–æ–≤ –ø–æ–≤–æ—Ä–æ—Ç–∞ –∏ —Ç.–¥.);

- [opentripplanner](https://github.com/ropensci/opentripplanner){target="_blank"} -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ **R**, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ –≥–∏–±–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è [OpenTripPlanner (OTP)](https://www.opentripplanner.org/){target="_blank"}. OTP -- —ç—Ç–æ —Å–µ—Ä–≤–∏—Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –ø–æ–µ–∑–¥–æ–∫, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ **Java**.

- [stplanr](https://github.com/ropensci/stplanr){target="_blank"} -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞  –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–º–æ—â—å—é **R**.

## –°–µ—Ç—å –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏: 

- [hereR](https://munterfi.github.io/hereR/){target="_blank"} -- –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏—Å–∫–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞, –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –∏ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–µ–∑–¥–∞, –∞ —Ç–∞–∫–∂–µ –∏–∑–æ–ª–∏–Ω–∏–∏, –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Ç–æ–∫–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞—Ö –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –Ω–∞—Ö–æ–¥–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ —Ç.–¥.;

- [graphhopper](https://github.com/crazycapivara/graphhopper-r){target="_blank"} -- –±—ã—Å—Ç—Ä—ã–π –∏ –ø—Ä–æ—Å—Ç–æ–π –¥–æ—Å—Ç—É–ø –∫ [API GraphHopper Directions](https://www.graphhopper.com/open-source/){target="_blank"};

- [r5r](https://ipeagit.github.io/r5r/){target="_blank"} -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å–µ—Ç—è—Ö (–ø–µ—à–∫–æ–º, –≤–µ–ª–æ—Å–∏–ø–µ–¥–µ, –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ), –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –∏ —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è $R^5$ ([Rapid Realistic Routing on Real-world and Reimagined networks](https://github.com/conveyal/r5){target="_blank"});

- [tidytransit](https://r-transit.github.io/tidytransit/){target="_blank"} —Å–ª—É–∂–∏—Ç –¥–ª—è –∫–∞—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∏—Ç–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤, —Ä–∞—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø—É—Ç–∏ –∏ —á–∞—Å—Ç–æ—Ç—ã —Ç—Ä–∞–Ω–∑–∏—Ç–∞, –∞ —Ç–∞–∫–∂–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–∞–Ω–∑–∏—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö;

- [gtfsio](https://r-transit.github.io/gtfsio/){target="_blank"}, [gtfstools](https://ipeagit.github.io/gtfstools/){target="_blank"}, [gtfsrouter](https://urbananalyst.github.io/gtfsrouter/){target="_blank"}, [gtfs2gps](https://ipeagit.github.io/gtfs2gps/){target="_blank"} -- –Ω–∞–±–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç—ã –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞.

## –ö–Ω–∏–≥–∏, –≥–ª–∞–≤—ã –∫–Ω–∏–≥ –∏ —Å—Ç–∞—Ç—å–∏, –∫–∞—Å–∞—é—â–∏–µ—Å—è —Å–µ—Ç–µ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤ **R** –∏ —Å–º–µ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

- –ì–ª–∞–≤–∞ [Transportation](https://r.geocompx.org/transport.html){target="_blank"} –≤ –∫–Ω–∏–≥–µ [Geocomputation with R](https://r.geocompx.org/){target="_blank"} —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Å–µ—Ç–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

- –ì–ª–∞–≤–∞ [–°–µ—Ç–µ–≤–æ–π –∞–Ω–∞–ª–∏–∑](https://tsamsonov.github.io/r-geo-course/16-NetworkAnalysis.html){target="_blank"} –∫—É—Ä—Å–∞ [–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏–∑ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —è–∑—ã–∫–µ R](https://tsamsonov.github.io/r-geo-course/){target="_blank"} –∏—Å—Å–ª–µ–¥—É–µ—Ç –∑–∞–¥–∞—á–∏ –∞–Ω–∞–ª–∏–∑–∞ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –∫–∞–∫ –∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ-—Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —Å–µ—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å), —Ç–∞–∫ –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ–º –∑–æ–Ω –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏.

- –ö–Ω–∏–≥–∞ [Introduction to urban accessibility](https://ipeagit.github.io/intro_access_book/){target="_blank"} –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Ç–æ, —á—Ç–æ–±—ã –¥–∞—Ç—å —á–∏—Ç–∞—Ç–µ–ª—è–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≥–æ—Ä–æ–¥–æ–≤ –∏ –æ—Ü–µ–Ω–∫–∏ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.

- –í —Å—Ç–∞—Ç—å–µ [Spatial networks in R with sf and tidygraph](https://r-spatial.org/r/2019/09/26/spatial-networks.html){target="_blank"} —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –ø–æ–¥—Ö–æ–¥—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö, –æ—á–∏—Å—Ç–∫–æ–π —Å–µ—Ç–∏, —Å–æ–∑–¥–∞–Ω–∏–µ–º –≥—Ä–∞—Ñ–∞ –¥–æ—Ä–æ–∂–Ω–æ–π —Å–µ—Ç–∏, –º–µ—Ä–∞–º–∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏, –ø–æ–∏—Å–∫–æ–º –∫—Ä–∞—Ç—á–∞–π—à–∏—Ö –ø—É—Ç–µ–π.

- –ö–Ω–∏–≥–∞ [Spatial Analysis along Networks: Statistical and Computational Methods](https://onlinelibrary.wiley.com/doi/book/10.1002/9781119967101) –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∏–∞–≥—Ä–∞–º–º—ã –í–æ—Ä–æ–Ω–æ–≥–æ, *K*-—Ñ—É–Ω–∫—Ü–∏–∏, –æ—Ü–µ–Ω–∫–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ç–æ—á–µ–∫) —Å –ø–ª–æ—â–∞–¥–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å–µ—Ç–∏.




:::{.callout-tip collapse="true"}
## Session Info
```{r}
#| echo: false

library(sessioninfo)

pkg_sesh <- session_info(pkgs = "attached")

quarto_version <- system("quarto --version", intern = TRUE)

pkg_sesh$platform$quarto <- paste(
  system("quarto --version", intern = TRUE)
  )

pkg_sesh
```

:::